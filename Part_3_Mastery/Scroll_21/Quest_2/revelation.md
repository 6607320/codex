# **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≠–º–±–µ–¥–¥–∏–Ω–≥–æ–≤–æ–≥–æ –ü–æ–∏—Å–∫–∞: –ì–ª—É–±–æ–∫–∏–µ –ù–µ–π—Ä–æ–Ω–Ω—ã–µ –°–µ—Ç–∏ –∏ –ü—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã–µ –ê–ª–≥–æ—Ä–∏—Ç–º—ã (ANN) –≤ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö –°–∏—Å—Ç–µ–º–∞—Ö**

## **1\. –í–≤–µ–¥–µ–Ω–∏–µ: –°–º–µ–Ω–∞ –ü–∞—Ä–∞–¥–∏–≥–º—ã –≤ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–º –ü–æ–∏—Å–∫–µ**

–í –ø–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ—Å—è—Ç–∏–ª–µ—Ç–∏–µ –ª–∞–Ω–¥—à–∞—Ñ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º –ø—Ä–µ—Ç–µ—Ä–ø–µ–ª —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–¥–≤–∏–≥, –ø–µ—Ä–µ–π–¥—è –æ—Ç —ç–≤—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –∏ –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∞—Ç—Ä–∏—Ü –∫ –≥–ª—É–±–æ–∫–æ–º—É –æ–±—É—á–µ–Ω–∏—é –∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º. –í —ç–ø–æ—Ö—É "–±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö", –∫–æ–≥–¥–∞ –∫–∞—Ç–∞–ª–æ–≥–∏ –Ω–∞—Å—á–∏—Ç—ã–≤–∞—é—Ç –º–∏–ª–ª–∏–∞—Ä–¥—ã —Ç–æ–≤–∞—Ä–æ–≤, –∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –±–∞–∑—ã ‚Äî –º–∏–ª–ª–∏–∞—Ä–¥—ã –ª—é–¥–µ–π, —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ–º —Ü–∏—Ñ—Ä–æ–≤—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º.  
–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ –ø–æ–∏—Å–∫ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –∏–ª–∏ –ø—Ä–æ—Å—Ç–∞—è –º–∞—Ç—Ä–∏—á–Ω–∞—è —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è —Å –Ω–µ–ø—Ä–µ–æ–¥–æ–ª–∏–º—ã–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏. –û–Ω–∏ —á–∞—Å—Ç–æ –Ω–µ —Å–ø–æ—Å–æ–±–Ω—ã —É–ª–æ–≤–∏—Ç—å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –Ω—é–∞–Ω—Å—ã –∑–∞–ø—Ä–æ—Å–æ–≤, —Å—Ç—Ä–∞–¥–∞—é—Ç –æ—Ç –ø—Ä–æ–±–ª–µ–º—ã "—Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞" –∏ –Ω–µ –º–æ–≥—É—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ç–µ–∫—Å—Ç, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤–∏–¥–µ–æ). –û—Ç–≤–µ—Ç–æ–º –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ —Å—Ç–∞–ª–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è **Embedding-Based Retrieval (EBR)** ‚Äî –ø–æ–∏—Å–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.  
–°—É—Ç—å —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø—Ä–æ–µ—Ü–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π —Ä–µ–∞–ª—å–Ω–æ–≥–æ –º–∏—Ä–∞ ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ç–æ–≤–∞—Ä–æ–≤, –≤–∏–¥–µ–æ—Ä–æ–ª–∏–∫–æ–≤, –ø–æ–∏—Å–∫–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Äî –≤ –æ–±—â–µ–µ –º–Ω–æ–≥–æ–º–µ—Ä–Ω–æ–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ (Latent Space). –í —ç—Ç–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –±–ª–∏–∑–æ—Å—Ç—å –æ–±—ä–µ–∫—Ç–æ–≤ –∫–æ–¥–∏—Ä—É–µ—Ç—Å—è –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º –º–µ–∂–¥—É –Ω–∏–º–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∑–∞–¥–∞—á–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏–∑ –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –≤ –∑–∞–¥–∞—á—É –ø–æ–∏—Å–∫–∞ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π (Nearest Neighbor Search).  
–û–¥–Ω–∞–∫–æ –ø–µ—Ä–µ—Ö–æ–¥ –∫ –≤–µ–∫—Ç–æ—Ä–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º –ø–æ—Ä–æ–∂–¥–∞–µ—Ç –Ω–æ–≤—ã–µ –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ –≤—ã–∑–æ–≤—ã. –ü—Ä—è–º–æ–π –ø–µ—Ä–µ–±–æ—Ä (Brute-force scan) –º–∏–ª–ª–∏–æ–Ω–æ–≤ –≤–µ–∫—Ç–æ—Ä–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω –≤ —Ä–∞–º–∫–∞—Ö –∂–µ—Å—Ç–∫–∏—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –∑–∞–¥–µ—Ä–∂–∫–µ (latency), —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã—Ö –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–µ–±\-—Å–µ—Ä–≤–∏—Å–æ–≤ (–æ–±—ã—á–Ω–æ \< 100 –º—Å). –≠—Ç–æ –ø—Ä–∏–≤–µ–ª–æ –∫ –±—É—Ä–Ω–æ–º—É —Ä–∞–∑–≤–∏—Ç–∏—é –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ **–ü—Ä–∏–±–ª–∏–∂–µ–Ω–Ω–æ–≥–æ –ü–æ–∏—Å–∫–∞ –ë–ª–∏–∂–∞–π—à–∏—Ö –°–æ—Å–µ–¥–µ–π (Approximate Nearest Neighbor ‚Äî ANN)**, —Ç–∞–∫–∏—Ö –∫–∞–∫ HNSW, ScaNN –∏ IVF, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –∑–∞ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è, –∂–µ—Ä—Ç–≤—É—è –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π –¥–æ–ª–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ —Ä–∞–¥–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.  
–î–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–µ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤. –ú—ã –¥–µ—Ç–∞–ª—å–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤–µ–∫—Ç–æ—Ä–æ–≤ (–≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, Two-Tower –º–æ–¥–µ–ª–∏), –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤—ã –º–µ—Ç—Ä–∏–∫ —Å—Ö–æ–¥—Å—Ç–≤–∞, —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ —Å –ø–æ–º–æ—â—å—é –±–æ–ª—å—à–∏—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π (LLM), –∞ —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ–¥–µ–º –≥–ª—É–±–æ–∫–∏–π —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ ANN, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±–µ–Ω—á–º–∞—Ä–∫–∏ –∏ –∫–µ–π—Å—ã –ª–∏–¥–µ—Ä–æ–≤ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏, —Ç–∞–∫–∏—Ö –∫–∞–∫ Amazon, Netflix, Spotify –∏ Google.

## **2\. –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –û—Å–Ω–æ–≤—ã –í–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π (Embeddings)**

–≠–º–±–µ–¥–¥–∏–Ω–≥ ‚Äî —ç—Ç–æ –ø–ª–æ—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä (dense vector) —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, d=128, 768, 1024), –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏–π –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–π –æ–±—ä–µ–∫—Ç –≤ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–º –≤–µ–∫—Ç–æ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ (sparse vectors), –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –≤ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª—è—Ö "–º–µ—à–∫–∞ —Å–ª–æ–≤" (Bag-of-Words) –∏–ª–∏ One-Hot Encoding, –≥–¥–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —Ä–∞–≤–Ω–∞ —Ä–∞–∑–º–µ—Ä—É —Å–ª–æ–≤–∞—Ä—è, –∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π ‚Äî –Ω—É–ª–∏, —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ —è–≤–ª—è—é—Ç—Å—è –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º–∏ –∏ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–º–∏.

### **2.1. –û—Ç –ú–∞—Ç—Ä–∏—á–Ω–æ–π –§–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫ –ì–ª—É–±–æ–∫–æ–º—É –û–±—É—á–µ–Ω–∏—é**

–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏, –ø–µ—Ä–≤—ã–º —à–∞–≥–æ–º –∫ –ª–∞—Ç–µ–Ω—Ç–Ω—ã–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º —Å—Ç–∞–ª–∞ –ú–∞—Ç—Ä–∏—á–Ω–∞—è –§–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (Matrix Factorization, MF). –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º –º–∞—Ç—Ä–∏—Ü—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π R —Ä–∞–∑–º–µ—Ä–∞ |U| \\times |I|, –≥–¥–µ —Å—Ç—Ä–æ–∫–∏ ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∞ —Å—Ç–æ–ª–±—Ü—ã ‚Äî —Ç–æ–≤–∞—Ä—ã. MF —Ä–∞—Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç —ç—Ç—É —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É –Ω–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –¥–≤—É—Ö –ø–ª–æ—Ç–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü –º–µ–Ω—å—à–µ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏: –º–∞—Ç—Ä–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π P (|U| \\times k) –∏ –º–∞—Ç—Ä–∏—Ü—ã —Ç–æ–≤–∞—Ä–æ–≤ Q (|I| \\times k). –°–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è p_u –∏ –≤–µ–∫—Ç–æ—Ä–∞ —Ç–æ–≤–∞—Ä–∞ q_i –¥–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥: \\hat{r}\_{ui} \= p_u \\cdot q_i.  
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, MF –ª–∏–Ω–µ–π–Ω–∞ –ø–æ —Å–≤–æ–µ–π –ø—Ä–∏—Ä–æ–¥–µ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –≤ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø–æ–±–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (side features), —Ç–∞–∫–æ–π –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—Ä–µ–º–µ–Ω–∏, –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞. –ì–ª—É–±–æ–∫–∏–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ (DNN) –ø—Ä–µ–æ–¥–æ–ª–µ–ª–∏ —ç—Ç–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –ø—Ä–µ–¥–ª–æ–∂–∏–≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, —Å–ø–æ—Å–æ–±–Ω—ã–µ –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä–æ–≤–∞—Ç—å –ª—é–±—ã–µ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.

### **2.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ "–î–≤—É—Ö –ë–∞—à–µ–Ω" (Two-Tower Model)**

–°—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –¥–µ\-—Ñ–∞–∫—Ç–æ –¥–ª—è —ç—Ç–∞–ø–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ (retrieval) –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —è–≤–ª—è–µ—Ç—Å—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ **Two-Tower** (–∏–ª–∏ Dual Encoder). –≠—Ç–∞ –º–æ–¥–µ–ª—å —Ä–∞–∑–¥–µ–ª—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ –¥–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ (–±–∞—à–Ω–∏), –∫–æ—Ç–æ—Ä—ã–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–∞–º–æ–º –ø–æ—Å–ª–µ–¥–Ω–µ–º —ç—Ç–∞–ø–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—Ö–æ–¥—Å—Ç–≤–∞.

#### **2.2.1. –ë–∞—à–Ω—è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Query Tower)**

–¶–µ–ª—å —ç—Ç–æ–π –ø–æ–¥—Å–µ—Ç–∏ ‚Äî —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

- **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
  - **ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:** –ü—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Å–ª–æ–π Embedding Lookup.
  - **–ò—Å—Ç–æ—Ä–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π:** –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å ID —Ç–æ–≤–∞—Ä–æ–≤, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞–ª. –≠—Ç–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Å–ª–æ—è–º–∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ (Average Pooling, Sum Pooling) –∏–ª–∏, –≤ –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞—Ö, —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã–º–∏ —Å–µ—Ç—è–º–∏ (GRU/LSTM) –∏–ª–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞–º–∏ –≤–Ω–∏–º–∞–Ω–∏—è (Self-Attention/Transformer), —á—Ç–æ–±—ã —É—á–µ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—É—é –¥–∏–Ω–∞–º–∏–∫—É –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤.
  - **–î–µ–º–æ–≥—Ä–∞—Ñ–∏—è:** –ü–æ–ª, –≤–æ–∑—Ä–∞—Å—Ç, –≥–µ–æ–≥—Ä–∞—Ñ–∏—è (–∫–æ–¥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ One-Hot –∏–ª–∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏).
  - **–ö–æ–Ω—Ç–µ–∫—Å—Ç:** –í—Ä–µ–º—è —Å—É—Ç–æ–∫, —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Ç–µ–∫—É—â–∞—è —Å–µ—Å—Å–∏—è.
- **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ:** –í—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É—é—Ç—Å—è –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –∫–∞—Å–∫–∞–¥ –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—ã—Ö —Å–ª–æ–µ–≤ (Dense Layers) —Å –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–º–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è–º–∏ (ReLU, Swish/GELU). –í—ã—Ö–æ–¥–æ–º —è–≤–ª—è–µ—Ç—Å—è –≤–µ–∫—Ç–æ—Ä u \\in \\mathbb{R}^d.

#### **2.2.2. –ë–∞—à–Ω—è –¢–æ–≤–∞—Ä–∞ (Candidate Tower)**

–¶–µ–ª—å ‚Äî —Å–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç–∏—á–Ω–æ–µ (–∏–ª–∏ –∫–≤–∞–∑–∏-—Å—Ç–∞—Ç–∏—á–Ω–æ–µ) –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.

- **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
  - **ID —Ç–æ–≤–∞—Ä–∞:** Embedding Lookup.
  - **–ö–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:** –¢–µ–∫—Å—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –∏ –æ–ø–∏—Å–∞–Ω–∏—è (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è BERT/Word2Vec), –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (ResNet/EfficientNet), –∞—É–¥–∏–æ-–ø—Ä–∏–∑–Ω–∞–∫–∏.
  - **–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:** –ë—Ä–µ–Ω–¥, –∂–∞–Ω—Ä, –ø—Ä–æ–¥–∞–≤–µ—Ü.
  - **–ß–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:** –¶–µ–Ω–∞, —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥, –≤–æ–∑—Ä–∞—Å—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
- **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –±–∞—à–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø—Ä–∏–∑–Ω–∞–∫–∏ –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –≤ –≤–µ–∫—Ç–æ—Ä v \\in \\mathbb{R}^d.

–í–∞–∂–Ω–µ–π—à–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã Two-Tower –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ "–ë–∞—à–Ω—è –¢–æ–≤–∞—Ä–∞" –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç **–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å** (pre-compute) —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è –≤—Å–µ—Ö –º–∏–ª–ª–∏–æ–Ω–æ–≤ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏—Ö –≤ –∏–Ω–¥–µ–∫—Å ANN. –í –º–æ–º–µ–Ω—Ç –∑–∞–ø—Ä–æ—Å–∞ —Å–∏—Å—Ç–µ–º–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –≤–µ–∫—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (online inference) –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π –≤ –∏–Ω–¥–µ–∫—Å–µ.

### **2.3. –§—É–Ω–∫—Ü–∏–∏ –ü–æ—Ç–µ—Ä—å –∏ –û–±—É—á–µ–Ω–∏–µ –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞**

–ö–∞—á–µ—Å—Ç–≤–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞–ø—Ä—è–º—É—é –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥–µ–æ–º–µ—Ç—Ä–∏–∏ –ª–∞—Ç–µ–Ω—Ç–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä–∞—è —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–æ—Ç–µ—Ä—å (Loss Function).

1. **Pointwise Loss (–ü–æ—Ç–æ—á–µ—á–Ω–∞—è):** –†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –∫–∞–∂–¥—É—é –ø–∞—Ä—É (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —Ç–æ–≤–∞—Ä) –∫–∞–∫ –Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é –∑–∞–¥–∞—á—É –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∫–ª–∏–∫/–Ω–µ –∫–ª–∏–∫) –∏–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (—Ä–µ–π—Ç–∏–Ω–≥). –ü—Ä–∏–º–µ—Ä: _Binary Cross Entropy_. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫: –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤.
2. **Pairwise Loss (–ü–æ–ø–∞—Ä–Ω–∞—è):** –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫. –ü—Ä–∏–º–µ—Ä: _BPR (Bayesian Personalized Ranking)_ –∏–ª–∏ _Triplet Loss_. –ú–æ–¥–µ–ª—å —É—á–∏—Ç—Å—è —Ç–æ–º—É, —á—Ç–æ "—Ç–æ–≤–∞—Ä –ê –ª—É—á—à–µ —Ç–æ–≤–∞—Ä–∞ –ë –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è U". –ì–¥–µ s ‚Äî —Ñ—É–Ω–∫—Ü–∏—è —Å—Ö–æ–¥—Å—Ç–≤–∞, m ‚Äî –º–∞—Ä–∂–∞. –≠—Ç–æ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –±—ã—Ç—å –±–ª–∏–∂–µ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —á–µ–º –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ.
3. **Listwise Loss (–°–ø–∏—Å–æ—á–Ω–∞—è):** –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞. –ü—Ä–∏–º–µ—Ä: _Sampled Softmax_. –í —ç—Ç–æ–º –ø–æ–¥—Ö–æ–¥–µ –∑–∞–¥–∞—á–∞ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –º—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, –≥–¥–µ –∫–∞–∂–¥—ã–π —Ç–æ–≤–∞—Ä ‚Äî —ç—Ç–æ –∫–ª–∞—Å—Å. –ü–æ—Å–∫–æ–ª—å–∫—É –∫–ª–∞—Å—Å–æ–≤ –º–∏–ª–ª–∏–æ–Ω—ã, –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å Softmax –∞–ø–ø—Ä–æ–∫—Å–∏–º–∏—Ä—É–µ—Ç—Å—è –≤—ã–±–æ—Ä–∫–æ–π –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ (Negative Sampling). –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–ø—ã—Ç YouTube ) –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ Sampled Softmax —Å –ø–æ–ø—Ä–∞–≤–∫–æ–π –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å (LogQ correction) –¥–∞–µ—Ç –Ω–∞–∏–ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–ª—è —ç—Ç–∞–ø–∞ Retrieval, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ—Ç –≤–∑–∞–∏–º–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏ —Ç–æ–≤–∞—Ä–æ–º.

## **3\. –ì–µ–æ–º–µ—Ç—Ä–∏—è –°—Ö–æ–¥—Å—Ç–≤–∞: –í—ã–±–æ—Ä –ú–µ—Ç—Ä–∏–∫–∏**

–í—ã–±–æ—Ä –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –ø–æ–∏—Å–∫–µ —Å–æ—Å–µ–¥–µ–π ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–µ—Ç–∞–ª—å, –∞ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–µ–µ —Å–µ–º–∞–Ω—Ç–∏–∫—É "–ø–æ—Ö–æ–∂–µ—Å—Ç–∏".

### **3.1. –°–∫–∞–ª—è—Ä–Ω–æ–µ –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ (Dot Product / Inner Product)**

–í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –º–æ–¥–µ–ª–µ–π –º–∞—Ç—Ä–∏—á–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ Two-Tower, –æ–±—É—á–µ–Ω–Ω—ã—Ö —Å Softmax, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ.

- **–§–∏–∑–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª:** –ú–µ—Ç—Ä–∏–∫–∞ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–∞–∫ _–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ_ (—É–≥–æ–ª), —Ç–∞–∫ –∏ _–º–∞–≥–Ω–∏—Ç—É–¥—É_ (–¥–ª–∏–Ω—É) –≤–µ–∫—Ç–æ—Ä–æ–≤.
- **–†–æ–ª—å –º–∞–≥–Ω–∏—Ç—É–¥—ã:** –í –ª–∞—Ç–µ–Ω—Ç–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –¥–ª–∏–Ω–∞ –≤–µ–∫—Ç–æ—Ä–∞ —Ç–æ–≤–∞—Ä–∞ \\|v\\| —á–∞—Å—Ç–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å –µ–≥–æ **–ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å—é** –∏–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ–º, –∞ –¥–ª–∏–Ω–∞ –≤–µ–∫—Ç–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è \\|u\\| ‚Äî —Å –µ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é. –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –∏–º–µ—é—Ç –≤–µ–∫—Ç–æ—Ä—ã –±–æ–ª—å—à–µ–π –¥–ª–∏–Ω—ã.
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –ø–æ–∏—Å–∫–µ –ø–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É —Å–∫–∞–ª—è—Ä–Ω–æ–º—É –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é (MIPS \- Maximum Inner Product Search), –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã (—Å –¥–ª–∏–Ω–Ω—ã–º–∏ –≤–µ–∫—Ç–æ—Ä–∞–º–∏) –±—É–¥—É—Ç –∏–º–µ—Ç—å –≤—ã—Å–æ–∫–∏–π —Å–∫–æ—Ä —Å _–ª—é–±—ã–º_ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –¥–∞–∂–µ –µ—Å–ª–∏ —É–≥–æ–ª –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–∞–º–∏ –≤–µ–ª–∏–∫ (–Ω–∏–∑–∫–æ–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ). –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—é –±–ª–æ–∫–±–∞—Å—Ç–µ—Ä–æ–≤ –≤ –≤—ã–¥–∞—á–µ.

### **3.2. –ö–æ—Å–∏–Ω—É—Å–Ω–æ–µ –°—Ö–æ–¥—Å—Ç–≤–æ (Cosine Similarity)**

- **–§–∏–∑–∏—á–µ—Å–∫–∏–π —Å–º—ã—Å–ª:** –ò–∑–º–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ —É–≥–æ–ª –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–∞–º–∏, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –∏—Ö –¥–ª–∏–Ω—É. –í—Å–µ –≤–µ–∫—Ç–æ—Ä—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –ø—Ä–æ–µ—Ü–∏—Ä—É—é—Ç—Å—è –Ω–∞ –µ–¥–∏–Ω–∏—á–Ω—É—é –≥–∏–ø–µ—Ä—Å—Ñ–µ—Ä—É.
- **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Ö–æ–∂–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ (item-to-item), –≥–¥–µ –≤–∞–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ, –∞ –Ω–µ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å. –¢–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å bias –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –≤ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏.
- **–°–≤—è–∑—å —Å –ï–≤–∫–ª–∏–¥–æ–≤—ã–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ–º:** –ï—Å–ª–∏ –≤–µ–∫—Ç–æ—Ä—ã –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã (\\|A\\|=\\|B\\|=1), —Ç–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–æ—Å–∏–Ω—É—Å—É —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—é –ø–æ –ï–≤–∫–ª–∏–¥–æ–≤—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é (L_2): –ß–µ–º –±–æ–ª—å—à–µ –∫–æ—Å–∏–Ω—É—Å, —Ç–µ–º –º–µ–Ω—å—à–µ L_2 —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ.

### **3.3. –ï–≤–∫–ª–∏–¥–æ–≤–æ –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ (L_2)**

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∂–µ –≤ —á–∏—Å—Ç–æ–º –≤–∏–¥–µ –¥–ª—è –≤—ã—Å–æ–∫–æ—Ä–∞–∑–º–µ—Ä–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏–∑\-–∑–∞ "–ø—Ä–æ–∫–ª—è—Ç–∏—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏", –Ω–æ —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—Ç–∏–≤–Ω–æ–π –º–µ—Ç—Ä–∏–∫–æ–π –¥–ª—è –º–Ω–æ–≥–∏—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, IVF). –ö–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –≤—ã—à–µ, –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –≤–µ–∫—Ç–æ—Ä–æ–≤ –æ–Ω–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ –∫–æ—Å–∏–Ω—É—Å–Ω–æ–º—É —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é.  
**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ:** –í–∞–∂–Ω–æ, —á—Ç–æ–±—ã –º–µ—Ç—Ä–∏–∫–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ø—Ä–∏ –ø–æ–∏—Å–∫–µ (inference), —Å–æ–≤–ø–∞–¥–∞–ª–∞ —Å –º–µ—Ç—Ä–∏–∫–æ–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏. –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –æ–±—É—á–∞–ª–∞—Å—å –º–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å Dot Product (Softmax), –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Cosine Similarity –ø—Ä–∏ –ø–æ–∏—Å–∫–µ –º–æ–∂–µ—Ç —É—Ö—É–¥—à–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è, —Ç–∞–∫ –∫–∞–∫ —Ç–µ—Ä—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–∞–≥–Ω–∏—Ç—É–¥–µ (–ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏), –∫–æ—Ç–æ—Ä—É—é –º–æ–¥–µ–ª—å "–≤—ã—É—á–∏–ª–∞" –∫–∞–∫ –≤–∞–∂–Ω—É—é. –û–¥–Ω–∞–∫–æ, –∏–Ω–æ–≥–¥–∞ –∏–Ω–∂–µ–Ω–µ—Ä—ã –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Cosine –ø—Ä–∏ –ø–æ–∏—Å–∫–µ, —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ (diversity) –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –Ω–∏—à–µ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç.

## **4\. –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–∏—Å–∫ –ü–æ—Ö–æ–∂–∏—Ö –û–±—ä–µ–∫—Ç–æ–≤ (Item-to-Item)**

–ó–∞–¥–∞—á–∞ "–ü–æ—Ö–æ–∂–∏–µ —Ç–æ–≤–∞—Ä—ã" (More like this) ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.

### **4.1. –ö–æ–Ω—Ç–µ–Ω—Ç–Ω—ã–µ –≠–º–±–µ–¥–¥–∏–Ω–≥–∏**

–ï—Å–ª–∏ —É –Ω–∞—Å –Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (–∏–ª–∏ –¥–ª—è —É—Å–∏–ª–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞), –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç.

- **–¢–µ–∫—Å—Ç:** –ù–∞–∑–≤–∞–Ω–∏—è –∏ –æ–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ BERT –∏–ª–∏ Sentence-Transformers. –ú–æ–¥–µ–ª—å paraphrase-multilingual-mpnet-base-v2 –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ä—É—Å—Å–∫–æ–≥–æ —è–∑—ã–∫–∞.
- **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:** –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–ª–æ–π ResNet50 –∏–ª–∏ ViT (Vision Transformer) –¥–∞–µ—Ç –≤–µ–∫—Ç–æ—Ä –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ —Å—Ç–∏–ª—è.
- **–ê–≥—Ä–µ–≥–∞—Ü–∏—è:** –í–µ–∫—Ç–æ—Ä—ã —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–∞–ª—å–Ω–æ—Å—Ç–µ–π –∫–æ–Ω–∫–∞—Ç–µ–Ω–∏—Ä—É—é—Ç—Å—è –∏–ª–∏ –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è (Multimodal Fusion), —Å–æ–∑–¥–∞–≤–∞—è –µ–¥–∏–Ω—ã–π –≤–µ–∫—Ç–æ—Ä —Ç–æ–≤–∞—Ä–∞. –ü–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π –≤ —ç—Ç–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –Ω–∞—Ö–æ–¥–∏—Ç —Ç–æ–≤–∞—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ _–≤—ã–≥–ª—è–¥—è—Ç_ –∏–ª–∏ _–æ–ø–∏—Å–∞–Ω—ã_ –ø–æ—Ö–æ–∂–µ.

### **4.2. –ö–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ (Item2Vec)**

–ü–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å Word2Vec, –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–µ—Å—Å–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ "–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ", –∞ —Ç–æ–≤–∞—Ä—ã –∫–∞–∫ "—Å–ª–æ–≤–∞". –û–±—É—á–∏–≤ –º–æ–¥–µ–ª—å Skip-gram –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è—Ö –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤, –º—ã –ø–æ–ª—É—á–∞–µ–º –≤–µ–∫—Ç–æ—Ä—ã —Ç–æ–≤–∞—Ä–æ–≤, –≥–¥–µ –±–ª–∏–∑–∫–∏–µ –≤–µ–∫—Ç–æ—Ä—ã –æ–∑–Ω–∞—á–∞—é—Ç —Ç–æ–≤–∞—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ _—á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ –≤ –æ–¥–Ω–æ–π —Å–µ—Å—Å–∏–∏_. –≠—Ç–æ —É–ª–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –±–ª–∏–∑–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, "—Ç–µ–ª–µ—Ñ–æ–Ω" –∏ "—á–µ—Ö–æ–ª" –º–æ–≥—É—Ç –±—ã—Ç—å –¥–∞–ª–µ–∫–∏ –ø–æ –∫–æ–Ω—Ç–µ–Ω—Ç—É, –Ω–æ –±–ª–∏–∑–∫–∏ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ Item2Vec).

## **5\. –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ (User-to-Item)**

–≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –ª–µ–Ω—Ç—ã –Ω–æ–≤–æ—Å—Ç–µ–π, –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã YouTube –∏–ª–∏ TikTok.

### **5.1. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –í–µ–∫—Ç–æ—Ä–∞ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**

–í–µ–∫—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ —Å—Ç–∞—Ç–∏—á–µ–Ω. –í —Å–∏—Å—Ç–µ–º–∞—Ö —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (TikTok) –æ–Ω –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥.

- **–ú–µ—Ö–∞–Ω–∏–∑–º:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ç–æ–ª—å–∫–æ —á—Ç–æ –ª–∞–π–∫–Ω—É–ª –≤–∏–¥–µ–æ –ø—Ä–æ "–∫–æ—Ç–æ–≤". ID —ç—Ç–æ–≥–æ –≤–∏–¥–µ–æ –ø–æ–¥–∞–µ—Ç—Å—è –≤ –º–æ–¥–µ–ª—å. –ú–æ–¥–µ–ª—å –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–∫—Ä—ã—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (hidden state) —Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–æ–π —Å–µ—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –≤–∑–≤–µ—à–µ–Ω–Ω–æ–µ –µ–≥–æ –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏.
- **–ü–æ–∏—Å–∫:** –ù–æ–≤—ã–π –≤–µ–∫—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è u\_{new} –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ ANN –∏–Ω–¥–µ–∫—Å. –°–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –≤–∏–¥–µ–æ, –±–ª–∏–∑–∫–∏–µ –∫ u\_{new} –≤ –ª–∞—Ç–µ–Ω—Ç–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ. –ü–æ—Å–∫–æ–ª—å–∫—É –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –æ–±—É—á–µ–Ω–æ —Ç–∞–∫, —á—Ç–æ–±—ã —Å–±–ª–∏–∂–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–µ –∏–º —Ç–æ–≤–∞—Ä—ã, –Ω–∞–π–¥–µ–Ω–Ω—ã–µ —Å–æ—Å–µ–¥–∏ ‚Äî —ç—Ç–æ –ª—É—á—à–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.

### **5.2. –í–æ—Ä–æ–Ω–∫–∞ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (The Funnel)**

–ü–æ–∏—Å–∫ —Å–æ—Å–µ–¥–µ–π ‚Äî —ç—Ç–æ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —ç—Ç–∞–ø (Candidate Generation).

1. **Retrieval (ANN):** –ò–∑ 100 –º–ª–Ω —Ç–æ–≤–∞—Ä–æ–≤ –æ—Ç–±–∏—Ä–∞–µ—Ç—Å—è —Ç–æ–ø-1000 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤. –ö—Ä–∏—Ç–µ—Ä–∏–π: –≤—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å, –≥—Ä—É–±–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Two-Tower –º–æ–¥–µ–ª—å.
2. **Filtering:** –û—Ç—Å–µ–∏–≤–∞–Ω–∏–µ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö, –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤–æ–∑—Ä–∞—Å—Ç—É —Ç–æ–≤–∞—Ä–æ–≤.
3. **Ranking (Scoring):** –î–ª—è 1000 –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –±–æ–ª–µ–µ —Ç—è–∂–µ–ª–∞—è –º–æ–¥–µ–ª—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, Gradient Boosting –∏–ª–∏ Deep Cross Network), –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è —Å–æ—Ç–Ω–∏ —Ñ–∏—á–µ–π (–≤—Ä–µ–º—è —Å—É—Ç–æ–∫, –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è).
4. **Re-ranking:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏—è (—á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ 10 –≤–∏–¥–µ–æ –æ–¥–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞ –ø–æ–¥—Ä—è–¥), –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞.

## **6\. –ü—Ä–æ–±–ª–µ–º–∞ –•–æ–ª–æ–¥–Ω–æ–≥–æ –°—Ç–∞—Ä—Ç–∞ –∏ –†–æ–ª—å LLM**

–û–¥–Ω–∞ –∏–∑ –≥–ª–∞–≤–Ω—ã—Ö –±–æ–ª–µ–π —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º ‚Äî –Ω–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã (Cold Start Items), —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π, –∞ –∑–Ω–∞—á–∏—Ç, –Ω–µ—Ç –æ–±—É—á–µ–Ω–Ω–æ–≥–æ ID-—ç–º–±–µ–¥–¥–∏–Ω–≥–∞.

### **6.1. –ì–∏–±—Ä–∏–¥–Ω—ã–µ –≠–º–±–µ–¥–¥–∏–Ω–≥–∏**

–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–∏–±—Ä–∏–¥–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –í–µ–∫—Ç–æ—Ä —Ç–æ–≤–∞—Ä–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ —Å—É–º–º–∞ (–∏–ª–∏ –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å–º–µ—Å—å) ID-—ç–º–±–µ–¥–¥–∏–Ω–≥–∞ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.  
–î–ª—è –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ E\_{id} –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –Ω—É–ª—è–º–∏ –∏–ª–∏ —Å–ª—É—á–∞–π–Ω—ã–º —à—É–º–æ–º, –Ω–æ E\_{content} (–∏–∑ —Ç–µ–∫—Å—Ç–∞/–∫–∞—Ä—Ç–∏–Ω–∫–∏) –Ω–µ—Å–µ—Ç —Å–º—ã—Å–ª–æ–≤—É—é –Ω–∞–≥—Ä—É–∑–∫—É, –ø–æ–∑–≤–æ–ª—è—è –Ω–∞–π—Ç–∏ "–ø–æ—Ö–æ–∂–∏–µ" —Ç–æ–≤–∞—Ä—ã —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏. –ú–µ—Ö–∞–Ω–∏–∑–º –≤–Ω–∏–º–∞–Ω–∏—è –º–æ–∂–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –≤–µ—Å E\_{id} –ø–æ –º–µ—Ä–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.

### **6.2. LLM –∫–∞–∫ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ó–Ω–∞–Ω–∏–π (Zero-Shot)**

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (state-of-the-art) –∑–∞–¥–µ–π—Å—Ç–≤—É–µ—Ç –ë–æ–ª—å—à–∏–µ –Ø–∑—ã–∫–æ–≤—ã–µ –ú–æ–¥–µ–ª–∏ (LLM). LLM –æ–±–ª–∞–¥–∞—é—Ç –æ–≥—Ä–æ–º–Ω–æ–π –±–∞–∑–æ–π –∑–Ω–∞–Ω–∏–π –æ –º–∏—Ä–µ. –ï—Å–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–Ω–∏–≥–∞ "–ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä", LLM —É–∂–µ "–∑–Ω–∞–µ—Ç", —á—Ç–æ —ç—Ç–æ —Ñ—ç–Ω—Ç–µ–∑–∏, –º–∞–≥–∏—è, –ø–æ—Ö–æ–∂–µ –Ω–∞ "–í–ª–∞—Å—Ç–µ–ª–∏–Ω –ö–æ–ª–µ—Ü".  
**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ CoLLM (Collaborative LLM):**

1. **Semantic Space:** LLM –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥ –æ–ø–∏—Å–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ e\_{llm}. –≠—Ç–æ—Ç –≤–µ–∫—Ç–æ—Ä –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ "—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ" (–≥–¥–µ —Å–ª–æ–≤–∞ –±–ª–∏–∑–∫–∏ –ø–æ —Å–º—ã—Å–ª—É).
2. **Collaborative Space:** –†–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ "–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ" (–≥–¥–µ —Ç–æ–≤–∞—Ä—ã –±–ª–∏–∑–∫–∏, –µ—Å–ª–∏ –∏—Ö –ø–æ–∫—É–ø–∞—é—Ç –æ–¥–Ω–∏ –ª—é–¥–∏). –≠—Ç–∏ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç.
3. **Mapping Module (–ú–æ–¥—É–ª—å –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è):** –û–±—É—á–∞–µ—Ç—Å—è –ª–µ–≥–∫–∞—è –Ω–µ–π—Ä–æ—Å–µ—Ç—å (MLP –∏–ª–∏ –ª–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è), –∫–æ—Ç–æ—Ä–∞—è —É—á–∏—Ç—Å—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å e\_{llm} –≤ –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–π –≤–µ–∫—Ç–æ—Ä e\_{cf}. –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ "—Ç–µ–ø–ª—ã—Ö" —Ç–æ–≤–∞—Ä–∞—Ö, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –∏–∑–≤–µ—Å—Ç–Ω—ã –æ–±–∞ –≤–µ–∫—Ç–æ—Ä–∞.
4. **Inference:** –î–ª—è –Ω–æ–≤–æ–≥–æ —Ö–æ–ª–æ–¥–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –º—ã –±–µ—Ä–µ–º –µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏–µ, –ø—Ä–æ–≥–æ–Ω—è–µ–º —á–µ—Ä–µ–∑ LLM, –∑–∞—Ç–µ–º —á–µ—Ä–µ–∑ Mapping Module –∏ –ø–æ–ª—É—á–∞–µ–º –ø—Å–µ–≤–¥–æ-–∫–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –≤–µ–∫—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –¥–æ–±–∞–≤–ª—è—Ç—å –≤ –∏–Ω–¥–µ–∫—Å. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å –Ω–æ–≤–∏–Ω–∫—É —Ç–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, —á—å–∏ –≤–µ–∫—Ç–æ—Ä–∞ "—Å–º–æ—Ç—Ä—è—Ç" –≤ —ç—Ç—É –æ–±–ª–∞—Å—Ç—å –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞, –±–µ–∑ –µ–¥–∏–Ω–æ–≥–æ –∫–ª–∏–∫–∞.

## **7\. –ü—Ä–∏–±–ª–∏–∂–µ–Ω–Ω—ã–π –ü–æ–∏—Å–∫ –ë–ª–∏–∂–∞–π—à–∏—Ö –°–æ—Å–µ–¥–µ–π (ANN) –¥–ª—è –ë–æ–ª—å—à–∏—Ö –î–∞–Ω–Ω—ã—Ö**

–ö–æ–≥–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–µ–∫—Ç–æ—Ä–æ–≤ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–ª–ª–∏–æ–Ω–æ–≤, –ª–∏–Ω–µ–π–Ω—ã–π –ø–æ–∏—Å–∫ O(N) —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º. ANN –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Å—Ç—Ä–æ—è—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ –∏—Å–∫–∞—Ç—å –∑–∞ O(\\log N). –†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–µ–º–µ–π—Å—Ç–≤–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤.

### **7.1. HNSW (Hierarchical Navigable Small World)**

–ù–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å HNSW ‚Äî —ç—Ç–æ "–∑–æ–ª–æ—Ç–æ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç" –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–∞ CPU, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π –Ω–∞–∏–ª—É—á—à–∏–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Å–∫–æ—Ä–æ—Å—Ç—å—é –∏ –ø–æ–ª–Ω–æ—Ç–æ–π (Recall).  
**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:** –ê–ª–≥–æ—Ä–∏—Ç–º –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –≥—Ä–∞—Ñ–∞—Ö "—Ç–µ—Å–Ω–æ–≥–æ –º–∏—Ä–∞". –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–π –≥—Ä–∞—Ñ (–∫–∞–∫ Skip List).

- **–ù–∏–∂–Ω–∏–π —Å–ª–æ–π (Layer 0):** –°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –≤–µ–∫—Ç–æ—Ä—ã. –≠—Ç–æ –ø–ª–æ—Ç–Ω—ã–π –≥—Ä–∞—Ñ, –≥–¥–µ –∫–∞–∂–¥—ã–π —É–∑–µ–ª —Å–≤—è–∑–∞–Ω —Å M –±–ª–∏–∂–∞–π—à–∏–º–∏ —Å–æ—Å–µ–¥—è–º–∏.
- **–í–µ—Ä—Ö–Ω–∏–µ —Å–ª–æ–∏:** –°–æ–¥–µ—Ä–∂–∞—Ç —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ —É–∑–ª–æ–≤. –°–≤—è–∑–∏ –∑–¥–µ—Å—å "–¥–ª–∏–Ω–Ω—ã–µ", –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ –¥–µ–ª–∞—Ç—å –≥–∏–≥–∞–Ω—Ç—Å–∫–∏–µ –ø—Ä—ã–∂–∫–∏ —á–µ—Ä–µ–∑ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.

**–ü–æ–∏—Å–∫:**

1. –ú—ã –Ω–∞—á–∏–Ω–∞–µ–º –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —Å–ª–æ–µ. –ñ–∞–¥–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–æ—Å–µ–¥—É, –∫–æ—Ç–æ—Ä—ã–π –±–ª–∏–∂–µ –∫ –≤–µ–∫—Ç–æ—Ä—É –∑–∞–ø—Ä–æ—Å–∞ q.
2. –î–æ—Å—Ç–∏–≥–Ω—É–≤ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ —Ç–µ–∫—É—â–µ–º —Å–ª–æ–µ, –º—ã "—Å–ø—É—Å–∫–∞–µ–º—Å—è" –Ω–∞ —Å–ª–æ–π –Ω–∏–∂–µ.
3. –ù–∞ –Ω–∏–∂–Ω–µ–º —Å–ª–æ–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫.

**–ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- M: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤—è–∑–µ–π –Ω–∞ —É–∑–µ–ª (–æ–±—ã—á–Ω–æ 16-64). –ë–æ–ª—å—à–µ M ‚Äî –≤—ã—à–µ Recall, –Ω–æ –±–æ–ª—å—à–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏.
- efConstruction: –ì–ª—É–±–∏–Ω–∞ –ø–æ–∏—Å–∫–∞ –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –∏–Ω–¥–µ–∫—Å–∞. –í–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –≥—Ä–∞—Ñ–∞ –∏ –≤—Ä–µ–º—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏.
- efSearch: –†–∞–∑–º–µ—Ä —Å–ø–∏—Å–∫–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –ø—Ä–∏ –ø–æ–∏—Å–∫–µ. –ö–æ–º–ø—Ä–æ–º–∏—Å—Å –º–µ–∂–¥—É Latency –∏ Recall.

**–ü–ª—é—Å—ã:** –í—ã—Å–æ—á–∞–π—à–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. **–ú–∏–Ω—É—Å—ã:** –í—ã—Å–æ–∫–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ (–Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —Å–∞–º –≥—Ä–∞—Ñ \+ –≤–µ–∫—Ç–æ—Ä—ã).

### **7.2. IVF (Inverted File Index)**

–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥, –ø–æ–ø—É–ª—è—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π **FAISS** (Facebook AI Similarity Search), –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏.  
**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**

1. –í–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ K –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (—è—á–µ–µ–∫ –í–æ—Ä–æ–Ω–æ–≥–æ) —Å –ø–æ–º–æ—â—å—é k-means.
2. –ö–∞–∂–¥—ã–π –≤–µ–∫—Ç–æ—Ä –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –±–ª–∏–∂–∞–π—à–µ–º—É —Ü–µ–Ω—Ç—Ä–æ–∏–¥—É –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π "–∏–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫".
3. –ü—Ä–∏ –ø–æ–∏—Å–∫–µ –∑–∞–ø—Ä–æ—Å–∞ q –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è nprobe –±–ª–∏–∂–∞–π—à–∏—Ö —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤.
4. –ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.

**–°–∂–∞—Ç–∏–µ (Product Quantization \- PQ):** IVF —á–∞—Å—Ç–æ –∫–æ–º–±–∏–Ω–∏—Ä—É—é—Ç —Å PQ –¥–ª—è –∫–æ–ª–æ—Å—Å–∞–ª—å–Ω–æ–π —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏. –í–µ–∫—Ç–æ—Ä —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ m —á–∞—Å—Ç–µ–π, –∫–∞–∂–¥–∞—è —á–∞—Å—Ç—å –∫–≤–∞–Ω—Ç—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –º–∏–ª–ª–∏–∞—Ä–¥—ã –≤–µ–∫—Ç–æ—Ä–æ–≤ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏ (—Å–∂–∞—Ç–∏–µ –≤ 10-20 —Ä–∞–∑).  
**–ü–ª—é—Å—ã:** –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –Ω–∞ –º–∏–ª–ª–∏–∞—Ä–¥—ã –≤–µ–∫—Ç–æ—Ä–æ–≤, –æ—Ç–ª–∏—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ GPU. **–ú–∏–Ω—É—Å—ã:** –¢—Ä–µ–±—É–µ—Ç —Ñ–∞–∑—ã –æ–±—É—á–µ–Ω–∏—è (clustering), —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º.

### **7.3. ScaNN (Scalable Nearest Neighbors)**

–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ Google, –Ω–∞—Ü–µ–ª–µ–Ω–Ω–∞—è –Ω–∞ –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è (MIPS).  
**–ò–Ω–Ω–æ–≤–∞—Ü–∏—è: –ê–Ω–∏–∑–æ—Ç—Ä–æ–ø–Ω–æ–µ –ö–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ.** –û–±—ã—á–Ω–æ–µ –∫–≤–∞–Ω—Ç–æ–≤–∞–Ω–∏–µ (–∫–∞–∫ –≤ FAISS PQ) –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç –ï–≤–∫–ª–∏–¥–æ–≤–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –≤–µ–∫—Ç–æ—Ä–æ–º –∏ –µ–≥–æ —Å–∂–∞—Ç–æ–π –≤–µ—Ä—Å–∏–µ–π. –û–¥–Ω–∞–∫–æ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (Dot Product) –æ—à–∏–±–∫–∞, –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–∞—è –≤–µ–∫—Ç–æ—Ä—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –Ω–µ –≤–∞–∂–Ω–∞. –í–∞–∂–Ω–∞ —Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∞ –≤–¥–æ–ª—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–∞. ScaNN –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å, –∫–æ—Ç–æ—Ä–∞—è —à—Ç—Ä–∞—Ñ—É–µ—Ç –æ—à–∏–±–∫–∏ "–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ" —Ü–µ–ª–µ–≤–æ–º—É –≤–µ–∫—Ç–æ—Ä—É —Å–∏–ª—å–Ω–µ–µ, —á–µ–º "–æ—Ä—Ç–æ–≥–æ–Ω–∞–ª—å–Ω—ã–µ".  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ScaNN —á–∞—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤ 2 —Ä–∞–∑–∞ –±–æ–ª—å—à—É—é –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å (QPS) –ø—Ä–∏ —Ç–æ–º –∂–µ Recall, —á–µ–º HNSW –∏–ª–∏ FAISS, –Ω–∞ –∑–∞–¥–∞—á–∞—Ö MIPS.

### **7.4. Annoy (Approximate Nearest Neighbors Oh Yeah)**

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –æ—Ç Spotify, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è —Å–ª—É—á–∞–π–Ω—ã–µ –ø—Ä–æ–µ–∫—Ü–∏–æ–Ω–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è (Random Projection Trees).  
**–ü—Ä–∏–Ω—Ü–∏–ø:** –ü—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –¥–µ–ª–∏—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–º–∏ –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—è–º–∏, –æ–±—Ä–∞–∑—É—è –±–∏–Ω–∞—Ä–Ω–æ–µ –¥–µ—Ä–µ–≤–æ. –ß—Ç–æ–±—ã —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã, —Å—Ç—Ä–æ–∏—Ç—Å—è "–ª–µ—Å" –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –¥–µ—Ä–µ–≤—å–µ–≤.  
**–ü–ª—é—Å—ã:** –ò–Ω–¥–µ–∫—Å –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤ –ø–∞–º—è—Ç—å (mmap). –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å—ã, –ø—Ä–µ–≤—ã—à–∞—é—â–∏–µ —Ä–∞–∑–º–µ—Ä RAM, –∏ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ —à–∞—Ä–∏—Ç—å –∏—Ö –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏. **–ú–∏–Ω—É—Å—ã:** –ú–µ–¥–ª–µ–Ω–Ω–µ–µ –≥—Ä–∞—Ñ–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤, –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ–æ–±—É—á–µ–Ω–∏–µ (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω–¥–µ–∫—Å).

## **8\. –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ê–Ω–∞–ª–∏–∑ –∏ –í—ã–±–æ—Ä –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞**

–°–≤–µ–¥–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è –∏–Ω–∂–µ–Ω–µ—Ä–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è.

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞         | HNSW                         | IVF-PQ (FAISS)           | ScaNN                       | Annoy                          |
| :--------------------- | :--------------------------- | :----------------------- | :-------------------------- | :----------------------------- |
| **–°—Ü–µ–Ω–∞—Ä–∏–π**           | Real-time –ø–æ–∏—Å–∫ (\<100 –º–ª–Ω)  | –ú–∞—Å—à—Ç–∞–± (\>100 –º–ª–Ω), GPU | High-load MIPS –Ω–∞ CPU       | Mobile / Embedded / Disk-based |
| **–¢–æ—á–Ω–æ—Å—Ç—å (Recall)**  | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (–õ—É—á—à–∞—è)          | ‚≠ê‚≠ê‚≠ê (–•–æ—Ä–æ—à–∞—è)         | ‚≠ê‚≠ê‚≠ê‚≠ê (–û—Ç–ª–∏—á–Ω–∞—è –¥–ª—è Dot) | ‚≠ê‚≠ê (–°—Ä–µ–¥–Ω—è—è)                 |
| **–°–∫–æ—Ä–æ—Å—Ç—å (Latency)** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (–°–≤–µ—Ä—Ö–±—ã—Å—Ç—Ä–æ)     | ‚≠ê‚≠ê‚≠ê (–ë—ã—Å—Ç—Ä–æ)          | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (–°–≤–µ—Ä—Ö–±—ã—Å—Ç—Ä–æ)    | ‚≠ê‚≠ê (–°—Ä–µ–¥–Ω–µ)                  |
| **–ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ RAM**    | üî¥ –í—ã—Å–æ–∫–æ–µ (–í–µ–∫—Ç–æ—Ä—ã \+ –ì—Ä–∞—Ñ) | üü¢ –ù–∏–∑–∫–æ–µ (–°–∂–∞—Ç–∏–µ)       | üü° –°—Ä–µ–¥–Ω–µ–µ                  | üü¢ –ù–∏–∑–∫–æ–µ (mmap)               |
| **–û–±–Ω–æ–≤–ª–µ–Ω–∏—è**         | ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç (Add/Del)    | ‚ùå –°–ª–æ–∂–Ω–æ (Re-train)     | ‚ùå –°—Ç–∞—Ç–∏—á–Ω—ã–π                | ‚ùå –°—Ç–∞—Ç–∏—á–Ω—ã–π                   |
| **–ú–µ—Ç—Ä–∏–∫–∏**            | L2, Cosine, IP               | L2, IP                   | Inner Product               | L2, Cosine, Hamming, Manhattan |

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É:**

1. **–ú–∞–ª—ã–π/–°—Ä–µ–¥–Ω–∏–π –¥–∞—Ç–∞—Å–µ—Ç (\< 10-20 –º–ª–Ω –≤–µ–∫—Ç–æ—Ä–æ–≤):** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **HNSW** (—á–µ—Ä–µ–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ hnswlib, faiss –∏–ª–∏ nmslib). –≠—Ç–æ –¥–∞—Å—Ç –Ω–∞–∏–ª—É—á—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É –∏ –ø—Ä–æ—Å—Ç–æ—Ç—É —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏. –ü–∞–º—è—Ç—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤ –ª–µ–≥–∫–æ –≤–º–µ—â–∞–µ—Ç —Ç–∞–∫–∏–µ –æ–±—ä–µ–º—ã.
2. **–û–≥—Ä–æ–º–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç (\> 100 –º–ª–Ω –≤–µ–∫—Ç–æ—Ä–æ–≤):** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **FAISS —Å IVF-PQ**. –ë–µ–∑ —Å–∂–∞—Ç–∏—è —Å—Ç–æ–∏–º–æ—Å—Ç—å RAM –±—É–¥–µ—Ç –∑–∞–ø—Ä–µ–¥–µ–ª—å–Ω–æ–π. –ï—Å–ª–∏ –µ—Å—Ç—å GPU, FAISS –æ–±–µ—Å–ø–µ—á–∏—Ç —Ñ–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–ø—É—Å–∫–Ω—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å.
3. **–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞ MIPS (–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏):** –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Two-Tower –º–æ–¥–µ–ª—å –∏ –º–µ—Ç—Ä–∏–∫—É —Å–∫–∞–ª—è—Ä–Ω–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –Ω–∞ CPU, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ **ScaNN**. –û–Ω –º–æ–∂–µ—Ç –¥–∞—Ç—å –≤—ã–∏–≥—Ä—ã—à –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
4. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å / –ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Annoy**. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å mmap –∫—Ä–∏—Ç–∏—á–Ω–∞, –µ—Å–ª–∏ –∏–Ω–¥–µ–∫—Å –Ω–µ –≤–ª–µ–∑–∞–µ—Ç –≤ RAM.

## **9\. –ë–∏–∑–Ω–µ—Å-–¶–µ–Ω–Ω–æ—Å—Ç—å –∏ –ü—Ä–∏–º–µ—Ä—ã –í–Ω–µ–¥—Ä–µ–Ω–∏—è**

–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ –≤ —Å–ª–æ–∂–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –æ–ø—Ä–∞–≤–¥–∞–Ω—ã –∏—Ö –ø—Ä—è–º—ã–º –≤–ª–∏—è–Ω–∏–µ–º –Ω–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏.

- **Amazon:** –ü–æ –¥–∞–Ω–Ω—ã–º McKinsey –∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º –æ—Ç—á–µ—Ç–∞–º , –¥–≤–∏–∂–æ–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç **35%** –≤—Å–µ–π –≤—ã—Ä—É—á–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏. –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –ø–æ–∑–≤–æ–ª–∏–ª —É–ª–∞–≤–ª–∏–≤–∞—Ç—å —Å–≤—è–∑–∏ —Ç–∏–ø–∞ "–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–≤–∞—Ä" –∏ "–∑–∞–º–µ–Ω–∞", –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –≤–∏–¥–Ω—ã –≤ –ø—Ä–æ—Å—Ç–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ —Å–æ–≤–º–µ—Å—Ç–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫.
- **Netflix:** –ö–æ–º–ø–∞–Ω–∏—è –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç –æ—Ç —Å–≤–æ–µ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –≤ **$1 –º–∏–ª–ª–∏–∞—Ä–¥ –≤ –≥–æ–¥** –∑–∞ —Å—á–µ—Ç —Å–Ω–∏–∂–µ–Ω–∏—è –æ—Ç—Ç–æ–∫–∞ (Churn Rate). –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –ø–æ–º–æ–≥–∞—é—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å "–¥–ª–∏–Ω–Ω—ã–π —Ö–≤–æ—Å—Ç" –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—Å—Ç–∞—Ä—ã–µ —Ñ–∏–ª—å–º—ã), –∫–æ—Ç–æ—Ä—ã–π –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç —É–∑–∫–∏–º —Å–µ–≥–º–µ–Ω—Ç–∞–º –∞—É–¥–∏—Ç–æ—Ä–∏–∏, —É–¥–µ—Ä–∂–∏–≤–∞—è –∏—Ö –ø–æ–¥–ø–∏—Å–∫—É.
- **Spotify:** –ü–ª–µ–π–ª–∏—Å—Ç "Discover Weekly" —Å—Ç–∞–ª —Ñ–µ–Ω–æ–º–µ–Ω–æ–º –±–ª–∞–≥–æ–¥–∞—Ä—è –≥–∏–±—Ä–∏–¥–Ω–æ–º—É –ø–æ–¥—Ö–æ–¥—É (CF \+ Audio Embeddings). –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—â–∏–µ —Å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–º–∏ –ø–ª–µ–π–ª–∏—Å—Ç–∞–º–∏, —Å–ª—É—à–∞—é—Ç –º—É–∑—ã–∫—É –≤ **2 —Ä–∞–∑–∞ –¥–æ–ª—å—à–µ**, —á—Ç–æ –Ω–∞–ø—Ä—è–º—É—é –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∫–ª–∞–º–Ω—É—é –≤—ã—Ä—É—á–∫—É –∏ –ª–æ—è–ª—å–Ω–æ—Å—Ç—å.
- **TikTok:** –£—Å–ø–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ Real-time RecSys. –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–∑–≤–æ–ª—è–µ—Ç "–∑–∞—Ü–µ–ø–∏—Ç—å" –≤–Ω–∏–º–∞–Ω–∏–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞—Ç—å –µ–≥–æ —á–∞—Å–∞–º–∏, —Å–æ–∑–¥–∞–≤–∞—è –ø–µ—Ç–ª—é –≤–æ–≤–ª–µ—á–µ–Ω–Ω–æ—Å—Ç–∏.

## **10\. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ö–≤–µ—Å—Ç–∞ 21.2 —Ç—Ä–µ–±—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞, –æ–±—ä–µ–¥–∏–Ω—è—é—â–µ–≥–æ –ø–µ—Ä–µ–¥–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –≥–ª—É–±–æ–∫–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏ –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω–∂–µ–Ω–µ—Ä–∏—é.

1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Two-Tower –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** –¥–ª—è –æ–±—É—á–µ–Ω–∏—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏ –±–æ–≥–∞—Ç—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤, —Å–æ—á–µ—Ç–∞—è –ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç.
2. –î–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã **–•–æ–ª–æ–¥–Ω–æ–≥–æ –°—Ç–∞—Ä—Ç–∞** –≤–Ω–µ–¥—Ä—è–π—Ç–µ –≥–∏–±—Ä–∏–¥–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **LLM** —Å –º–æ–¥—É–ª—è–º–∏ –ø—Ä–æ–µ–∫—Ü–∏–∏ (Mapping Modules) –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–µ–∫—Ç–æ—Ä–æ–≤ –Ω–æ–≤–∏–Ω–æ–∫.
3. –í—ã–±–∏—Ä–∞–π—Ç–µ **ANN –∞–ª–≥–æ—Ä–∏—Ç–º** –∏—Å—Ö–æ–¥—è –∏–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≤–∞—à–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã: **HNSW** –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –≥–∏–±–∫–æ—Å—Ç–∏ –≤ –ø–∞–º—è—Ç–∏, **IVF-PQ** –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –º–∏–ª–ª–∏–∞—Ä–¥—ã –æ–±—ä–µ–∫—Ç–æ–≤.
4. –ü–æ–º–Ω–∏—Ç–µ –æ –≥–µ–æ–º–µ—Ç—Ä–∏–∏: –≤—ã–±–æ—Ä –º–µ–∂–¥—É **Cosine Similarity** –∏ **Dot Product** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–æ—Ç–µ—Ä—å –≤–∞—à–µ–π –Ω–µ–π—Ä–æ—Å–µ—Ç–∏.

–í–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–µ—Ä–µ—Å—Ç–∞–ª –±—ã—Ç—å –Ω–∏—à–µ–≤–æ–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–µ–π –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–π –∏ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª—Å—è –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∏–Ω–¥—É—Å—Ç—Ä–∏–∏, –ª–µ–∂–∞—â–∏–π –≤ –æ—Å–Ω–æ–≤–µ –ª—é–±–æ–≥–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞, –ø—Ä–µ—Ç–µ–Ω–¥—É—é—â–µ–≥–æ –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é.

### **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –ü—Ä–∏–º–µ—Ä—ã –ö–æ–¥–∞**

**–ü—Ä–∏–º–µ—Ä 1: –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ HNSW –≤ FAISS (Python)**  
`import faiss`  
`import numpy as np`

`# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã`  
`d = 768          # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, BERT)`  
`M = 32           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤—è–∑–µ–π –≤ –≥—Ä–∞—Ñ–µ`  
`efSearch = 64    # –ì–ª—É–±–∏–Ω–∞ –ø–æ–∏—Å–∫–∞ (—Ç–æ—á–Ω–æ—Å—Ç—å vs —Å–∫–æ—Ä–æ—Å—Ç—å)`

`# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª—É—á–∞–π–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–∏–º–µ—Ä–∞`  
`xb = np.random.random((100000, d)).astype('float32') # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö`  
`xq = np.random.random((5, d)).astype('float32')      # –ó–∞–ø—Ä–æ—Å—ã`

`# –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ HNSW`  
`index = faiss.IndexHNSWFlat(d, M)`

`# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –≤ —Ä–∞–Ω—Ç–∞–π–º–µ)`  
`index.hnsw.efConstruction = 40  # –ì–ª—É–±–∏–Ω–∞ –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ (–≤–ª–∏—è–µ—Ç –Ω–∞ –≤—Ä–µ–º—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏)`  
`index.hnsw.efSearch = efSearch`

`# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤ (–æ–±—É—á–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è HNSWFlat)`  
`index.add(xb)`  
`print(f"–í—Å–µ–≥–æ –≤–µ–∫—Ç–æ—Ä–æ–≤ –≤ –∏–Ω–¥–µ–∫—Å–µ: {index.ntotal}")`

`# –ü–æ–∏—Å–∫`  
`k = 10 # –¢–æ–ø-10 —Å–æ—Å–µ–¥–µ–π`  
`D, I = index.search(xq, k) # D - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è, I - –∏–Ω–¥–µ–∫—Å—ã`  
`print("–ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π:", I)`

**–ü—Ä–∏–º–µ—Ä 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Annoy —Å mmap**  
`from annoy import AnnoyIndex`

`f = 128  # –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å`  
`t = AnnoyIndex(f, 'angular')  # 'angular' = Cosine Similarity`

`# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ`  
`for i in range(10000):`  
 `v = [random.gauss(0, 1) for z in range(f)]`  
 `t.add_item(i, v)`

`# –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ª–µ—Å–∞ (10 –¥–µ—Ä–µ–≤—å–µ–≤)`  
`t.build(10)`  
`t.save('test.ann')`

`# –ó–∞–≥—Ä—É–∑–∫–∞ –≤ —Ä–µ–∂–∏–º–µ mmap (—ç–∫–æ–Ω–æ–º–∏—Ç RAM)`  
`u = AnnoyIndex(f, 'angular')`  
`u.load('test.ann', prefault=False)`

`# –ü–æ–∏—Å–∫`  
`print(u.get_nns_by_item(0, 10)) # –ù–∞–π—Ç–∏ 10 –ø–æ—Ö–æ–∂–∏—Ö –Ω–∞ 0-–π —ç–ª–µ–º–µ–Ω—Ç`

#### **–ò—Å—Ç–æ—á–Ω–∏–∫–∏**

1\. Why Am I Seeing This?: Case Study: Amazon \- New America, https://www.newamerica.org/oti/reports/why-am-i-seeing-this/case-study-amazon/ 2\. How to Build a Deep Learning Powered Recommender System, Part ..., https://developer.nvidia.com/blog/how-to-build-a-winning-recommendation-system-part-2-deep-learning-for-recommender-systems/ 3\. In practical terms, what differences might you observe in a search system when using cosine similarity instead of Euclidean distance on the same set of normalized embeddings? \- Milvus, https://milvus.io/ai-quick-reference/in-practical-terms-what-differences-might-you-observe-in-a-search-system-when-using-cosine-similarity-instead-of-euclidean-distance-on-the-same-set-of-normalized-embeddings 4\. Is Cosine-Similarity of Embeddings Really About Similarity? \- arXiv, https://arxiv.org/html/2403.05440v1 5\. A Practical Guide to Building an Online ... \- Databricks, https://www.databricks.com/blog/guide-to-building-online-recommendation-system 6\. Measuring Similarity and Distance between Embeddings \- Dataquest, https://www.dataquest.io/blog/measuring-similarity-and-distance-between-embeddings/ 7\. When to use cosine simlarity over Euclidean similarity \- Data Science Stack Exchange, https://datascience.stackexchange.com/questions/27726/when-to-use-cosine-simlarity-over-euclidean-similarity 8\. Understanding the Impact of TikTok's Recommendation Algorithm on User Engagement, https://www.researchgate.net/publication/382423048\_Understanding\_the\_Impact\_of\_TikTok's\_Recommendation\_Algorithm\_on\_User\_Engagement 9\. \[2509.13179\] Efficient Cold-Start Recommendation via BPE Token-Level Embedding Initialization with LLM \- arXiv, https://arxiv.org/abs/2509.13179 10\. Evaluating Cold-Start in Recommendation Systems Using a Hybrid Model Based on Factorization Machines and SBERT Embeddings \- kth .diva, https://kth.diva-portal.org/smash/get/diva2:1710395/FULLTEXT01.pdf 11\. Foundation Model for Personalized Recommendation | by Netflix Technology Blog, https://netflixtechblog.com/foundation-model-for-personalized-recommendation-1a0bd8e02d39 12\. Large Language Model Simulator for Cold-Start Recommendation \- arXiv, https://arxiv.org/html/2402.09176v2 13\. Cold-Start Recommendation with Knowledge-Guided Retrieval-Augmented Generation \- arXiv, https://arxiv.org/html/2505.20773v1 14\. CoLLM: Integrating Collaborative Embeddings into Large Language Models for Recommendation \- arXiv, https://arxiv.org/pdf/2310.19488 15\. CoLLM-NAS: Collaborative Large Language Models for Efficient Knowledge-Guided Neural Architecture Search \- arXiv, https://www.arxiv.org/pdf/2509.26037 16\. What is a Hierarchical Navigable Small World \- MongoDB, https://www.mongodb.com/resources/basics/hierarchical-navigable-small-world 17\. Hierarchical Navigable Small Worlds (HNSW) \- Pinecone, https://www.pinecone.io/learn/series/faiss/hnsw/ 18\. Vector Database Search \- Hierarchical Navigable Small Worlds (HNSW) Explained, https://www.youtube.com/watch?v=77QH0Y2PYKg 19\. Annoy vs Faiss on Vector Search \- Zilliz blog, https://zilliz.com/blog/annoy-vs-faiss-choosing-the-right-tool-for-vector-search 20\. Approximate Nearest Neighbor (ANN) Search Explained: IVF vs HNSW vs PQ | TiDB, https://www.pingcap.com/article/approximate-nearest-neighbor-ann-search-explained-ivf-vs-hnsw-vs-pq/ 21\. Understanding IVF Vector Index: How It Works and When to Choose It Over HNSW \- Milvus, https://milvus.io/blog/understanding-ivf-vector-index-how-It-works-and-when-to-choose-it-over-hnsw.md 22\. What's the difference between FAISS, Annoy, and ScaNN? \- Milvus, https://milvus.io/ai-quick-reference/whats-the-difference-between-faiss-annoy-and-scann 23\. Faiss vs ScaNN on Vector Search \- Zilliz blog, https://zilliz.com/blog/faiss-vs-scann-choosing-the-right-tool-for-vector-search 24\. Vector Library versus Vector Database \- Weaviate, https://weaviate.io/blog/vector-library-vs-vector-database 25\. AI Product Recommendations: From Amazon's 35% to Your Store \- Firney, https://www.firney.com/news-and-insights/ai-product-recommendations-from-amazons-35-revenue-model-to-your-e-commerce-platform 26\. Amazon Recommender System \- UCSD Libraries, https://library.ucsd.edu/dc/object/bb8503744c/\_2\_1.pdf 27\. Netflix Personalization Engine & Sales Conversions Guide \- Articsledge, https://www.articsledge.com/post/netflix-s-personalization-engine-and-sales-conversions 28\. Netflix's Recommendation Systems: Entertainment Made for You, https://illumin.usc.edu/netflixs-recommendation-systems-entertainment-made-for-you/ 29\. Five years of discovery and engagement through Discover Weekly \- Spotify Advertising, https://ads.spotify.com/en-US/news-and-insights/five-years-of-discovery-and-engagement-through-discover-weekly/
