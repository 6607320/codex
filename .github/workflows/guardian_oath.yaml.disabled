# Имя нашего ритуала, которое будет видно в интерфейсе GitHub.
name: Ритуал Проверки Чистоты и Истинности

# Триггер остается тем же: пробуждайся при каждом 'push'.
on: [push]

# "Задания": Список задач, которые должен выполнить Страж.
jobs:
  # Мы даем нашей задаче общее имя, отражающее обе проверки.
  lint-and-test:
    # "Алтарь": Страж будет работать в мире 'ubuntu-latest'.
    runs-on: ubuntu-latest

    # "Шаги Ритуала": Последовательность действий Стража.
    steps:
      # Шаг 1: "Призыв Летописи" (без изменений).
      - name: 1. Призыв Летописи (Checkout Code)
        uses: actions/checkout@v4

      # Шаг 2: "Создание Магического Круга Python" (без изменений).
      - name: 2. Создание Магического Круга (Set up Python)
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      # Шаг 3: "Призыв Всех Инструментов". Теперь мы учим его призывать и pytest.
      - name: 3. Призыв Инструментов (Install Dependencies)
        run: |
          pip install flake8
          pip install pytest

      # Шаг 4: "Проверка Чистоты Рун" (без изменений).
      - name: 4. Проверка Чистоты (Lint with flake8)
        run: flake8 .

      # Шаг 5: !!! НОВЫЙ РИТУАЛ: "ИСПЫТАНИЕ ИСТИННОСТИ" !!!
      # Страж запускает 'pytest', чтобы проверить, что наша магия работает.
      - name: 5. Испытание Истинности (Test with pytest)
        run: pytest