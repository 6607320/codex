# "Имя Ритуала". Это имя будет сиять в Летописи GitHub Actions, ясно указывая на его миссию.
name: Deploy Static Site to GitHub Pages

# "Заклинание Пробуждения". Определяет, какое событие вдыхает жизнь в этот ритуал.
on:
  # Тип события: Ритуал пробуждается, когда Маг-Техномант вносит новые знания в Летопись (совершает 'push').
  push:
    # Уточнение №1: Пробуждение произойдет, только если изменения внесены в главную, каноническую ветвь 'main'.
    branches:
      - main
    # Уточнение №2 ("Избирательное Око"): Ритуал мудр и не тратит ману зря.
    # Он сработает, только если изменения коснулись священных артефактов в Хранилище 'static'.
    paths:
      - "tools/site_builder/static/**"

# "Наделение Силой". Мы даруем нашему духу-исполнителю (runner) магические права для выполнения миссии.
permissions:
  # Право на Чтение Летописи: Дух должен иметь возможность читать наш код.
  contents: read
  # Право на Запись в Хроники Сайта: Дух должен иметь право публиковать артефакт на GitHub Pages.
  pages: write
  # Право на Создание Магического Паспорта: Позволяет духу подтвердить свою личность перед GitHub Pages.
  id-token: write

# "Скрижаль Заданий". Здесь перечислены великие дела, которые должны быть исполнены.
jobs:
  # Уникальное имя нашего единственного, но важного задания.
  deploy:
    # "Алтарь для Ритуала": Мы выбираем надежный и знакомый мир 'ubuntu-latest' для проведения ритуала.
    runs-on: ubuntu-latest
    # "Шаги Ритуала": Точная и нерушимая последовательность магических действий.
    steps:
      # Имя первого шага, для ясности в логах.
      - name: Checkout repository
        # "Призыв Летописи на Алтарь": Мы используем готовое заклинание 'actions/checkout@v4',
        # чтобы создать точную копию нашего кода в ритуальном пространстве.
        uses: actions/checkout@v4

      # Имя второго, подготовительного шага.
      - name: Setup Pages
        # "Настройка Алтаря": Мы призываем духа 'actions/configure-pages@v4', который готовит
        # окружение для последующего развертывания на GitHub Pages.
        uses: actions/configure-pages@v4

      # Имя третьего шага, где мы создаем артефакт.
      - name: Upload artifact
        # "Запечатывание Артефакта": Мы используем заклинание 'actions/upload-pages-artifact@v3',
        # чтобы упаковать содержимое нашего Хранилища 'static' в единый, готовый к телепортации артефакт.
        uses: actions/upload-pages-artifact@v3
        # "Указ для Запечатывания": Мы точно указываем, где лежит наш священный артефакт.
        with:
          # Путь к папке, которая станет нашим сайтом.
          path: "tools/site_builder/static"

      # Имя четвертого, кульминационного шага.
      - name: Deploy to GitHub Pages
        # "Вознесение Артефакта": Мы призываем могущественное заклинание 'actions/deploy-pages@v4',
        # которое берет запечатанный артефакт и размещает его на публичном алтаре GitHub Pages.
        uses: actions/deploy-pages@v4
