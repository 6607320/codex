{
  "_meta": {
    "input_hash": "61295225f1da46458ae47d73f04a8a36"
  },
  "scenario": [
    {
      "command": "gcloud services enable artifactregistry.googleapis.com run.googleapis.com",
      "output": "Enabled services: artifactregistry.googleapis.com, run.googleapis.com",
      "is_final": false
    },
    {
      "command": "gcloud artifacts repositories create my-repo --repository-format=docker --location=us-central1",
      "output": "Created artifact repository 'my-repo' in location 'us-central1' with format 'docker'.",
      "is_final": false
    },
    {
      "command": "gcloud auth configure-docker us-central1-docker.pkg.dev",
      "output": "Docker config updated for us-central1-docker.pkg.dev",
      "is_final": false
    },
    {
      "command": "cd Part_4_Engineering/Scroll_28/Quest_2",
      "output": "Changed directory to Part_4_Engineering/Scroll_28/Quest_2",
      "is_final": false
    },
    {
      "command": "PROJECT_ID=$(gcloud config get-value project)",
      "output": "my-gcp-project",
      "is_final": false
    },
    {
      "command": "docker build -t us-central1-docker.pkg.dev/${PROJECT_ID}/my-repo/amulet:v1 .",
      "output": "Sending build context to Docker daemon  50.2MB\\nStep 1/9 : FROM python:3.10\\n ---> Using cache\\nStep 2/9 : WORKDIR /app\\n ---> Using cache\\nStep 3/9 : COPY libraries.list .\\n ---> Using cache\\nStep 4/9 : RUN pip install --no-cache-dir -r libraries.list\\n ---> Successfully installed fastapi==0.116.1 uvicorn==0.35.0 transformers==4.31.0 torch==2.1.0\\nStep 5/9 : COPY download_model.py .\\n ---> Using cache\\nStep 6/9 : RUN python download_model.py\\n Начинаю ритуал 'Предварительного Призыва Знаний'...\\n Знания успешно призваны и запечатаны.\\nStep 7/9 : COPY main.py .\\nStep 8/9 : COPY start.sh .\\nStep 9/9 : CMD [\"./start.sh\"]\\n ---> Done\\nSuccessfully built sha256:abcdef123456",
      "is_final": false
    },
    {
      "command": "docker push us-central1-docker.pkg.dev/${PROJECT_ID}/my-repo/amulet:v1",
      "output": "The push refers to repository us-central1-docker.pkg.dev/my-gcp-project/my-repo/amulet:v1\\nPreparing\\nPushing layers: 3/3\\nPushed 3/3 layers\\nPush complete",
      "is_final": false
    },
    {
      "command": "gcloud run deploy speaking-amulet --image=us-central1-docker.pkg.dev/${PROJECT_ID}/my-repo/amulet:v1 --memory=2Gi --region=us-central1 --allow-unauthenticated",
      "output": "Deploying container to Cloud Run service 'speaking-amulet' in region 'us-central1'...\\nDeployment complete. Service URL: https://speaking-amulet-abcdef-uc.a.run.app",
      "is_final": true
    }
  ]
}
