{
  "id": "5.2",
  "title": "–†–∏—Ç—É–∞–ª \"–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –ê–¥–∞–ø—Ç–∞—Ü–∏–∏\" (Fine-tune —Å `QLoRA` –º–æ–¥–µ–ª–∏ `distilgpt2`)",
  "legend": "<p><strong>üîÆ –õ–µ–≥–µ–Ω–¥–∞ –ö–≤–µ—Å—Ç–∞:</strong> –ú—ã –ø—Ä–∏—Å—Ç—É–ø–∞–µ–º –∫ –æ–¥–Ω–æ–º—É –∏–∑ —Å–∞–º—ã—Ö –º–æ–≥—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–∏—Ç—É–∞–ª–æ–≤ –≤ –∞—Ä—Å–µ–Ω–∞–ª–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –º–∞–≥–∞ ‚Äî <strong>Parameter-Efficient Fine-Tuning (PEFT)</strong>. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å –≤–µ—Å—å –º–Ω–æ–≥–æ–º–∏–ª–ª–∏–∞—Ä–¥–Ω—ã–π \"—Ä–∞–∑—É–º\" –ì–æ–ª–µ–º–∞ (—á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç –æ–≥—Ä–æ–º–Ω–æ–π \"–º–∞–Ω—ã\"), –º—ã –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ–º –∫ –Ω–µ–º—É –∫—Ä–æ—à–µ—á–Ω—ã–µ \"–º–∞–≥–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–Ω–æ—Ç—ã\" (<code>LoRA</code>). –ú—ã –±—É–¥–µ–º –æ–±—É—á–∞—Ç—å —Ç–æ–ª—å–∫–æ —ç—Ç–∏ \"–±–ª–æ–∫–Ω–æ—Ç—ã\", —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –Ω–∞–º –ø—Ä–æ–≤–µ—Å—Ç–∏ —Ä–∏—Ç—É–∞–ª –ù–∞—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–∞–∂–µ –Ω–∞ –Ω–∞—à–µ–º —Å–∫—Ä–æ–º–Ω–æ–º –ö—Ä–∏—Å—Ç–∞–ª–ª–µ –ú–∞–Ω—ã. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ—â–µ –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—É—é –º–∞–≥–∏—é <code>QLoRA</code>, –∫–æ—Ç–æ—Ä–∞—è —Å–Ω–∞—á–∞–ª–∞ \"—Å–∂–∏–º–∞–µ—Ç\" –ì–æ–ª–µ–º–∞ –¥–æ 4-–±–∏—Ç, –∞ —É–∂–µ –ø–æ—Ç–æ–º –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç –∫ –Ω–µ–º—É \"–±–ª–æ–∫–Ω–æ—Ç—ã\".</p>\n<p><strong>üìú –†–∏—Ç—É–∞–ª –¥–ª—è —ç—Ç–æ–≥–æ –∫–≤–µ—Å—Ç–∞:</strong>\n1. <strong>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ì—Ä–∏–º—É–∞—Ä–æ–≤:</strong> –£—Å—Ç–∞–Ω–æ–≤–∏ –≥—Ä–∏–º—É–∞—Ä—ã –¥–ª—è PEFT: <code>pip install peft bitsandbytes sentencepiece</code>. –í–µ—Ä–Ω–∏ <code>datasets</code> –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ (<code>pip install -U datasets</code>), —Ç–∞–∫ –∫–∞–∫ –Ω–æ–≤—ã–µ –≥—Ä–∏–º—É–∞—Ä—ã —Ç—Ä–µ–±—É—é—Ç —ç—Ç–æ–≥–æ.\n2. –ó–∞–ø—É—Å—Ç–∏ —Ä–∏—Ç—É–∞–ª: <code>python quest_5_2.py</code>.</p>\n<p><strong>‚ú® –û–∂–∏–¥–∞–µ–º—ã–π –†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —Ç—ã —É–≤–∏–¥–∏—à—å —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –ì–æ–ª–µ–º–∞ <code>distilgpt2</code>. –ó–∞—Ç–µ–º –Ω–∞—á–Ω–µ—Ç—Å—è –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è. –í –∫–æ–Ω—Å–æ–ª–∏ —Ç—ã —É–≤–∏–¥–∏—à—å –ª–æ–≥ –æ—Ç <code>Trainer</code>, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π, –∫–∞–∫ \"–û—à–∏–±–∫–∞\" (<code>Loss</code>) –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø–∞–¥–∞–µ—Ç. –í –∫–æ–Ω—Ü–µ –≤ —Ç–≤–æ–µ–π –º–∞—Å—Ç–µ—Ä—Å–∫–æ–π –ø–æ—è–≤–∏—Ç—Å—è –ø–∞–ø–∫–∞ <code>results/checkpoint-250</code>, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –æ–±—É—á–µ–Ω–Ω—ã–π \"–º–∞–≥–∏—á–µ—Å–∫–∏–π –±–ª–æ–∫–Ω–æ—Ç\".</p>\n<p><strong>üèÜ –ì–ª–∞–≤–Ω–æ–µ –æ–∑–∞—Ä–µ–Ω–∏–µ:</strong> –ú—ã –ø–æ—Å—Ç–∏–≥–ª–∏, —á—Ç–æ –¥–ª—è –ù–∞—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ì–æ–ª–µ–º–∞ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –±—ã—Ç—å –ê—Ä—Ö–∏–º–∞–≥–æ–º —Å –±–µ–∑–¥–æ–Ω–Ω—ã–º –ö—Ä–∏—Å—Ç–∞–ª–ª–æ–º –ú–∞–Ω—ã. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ <code>QLoRA</code> –∏ <code>PEFT</code> <strong>–¥–µ–º–æ–∫—Ä–∞—Ç–∏–∑–∏—Ä—É—é—Ç</strong> –º–∞–≥–∏—é. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–∞–º, –∏—Å–ø–æ–ª—å–∑—É—è –≤—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ–≥–∞–±–∞–π—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–∏–≥–∞–Ω—Ç—Å–∫–∏–µ –º–æ–¥–µ–ª–∏ –ø–æ–¥ —Å–≤–æ–∏ –Ω—É–∂–¥—ã. –ú—ã –ø–æ–Ω—è–ª–∏, —á—Ç–æ –æ–±—É—á–∞–µ–º –Ω–µ —Å–∞–º—É –º–æ–¥–µ–ª—å, –∞ –ª–∏—à—å –∫—Ä–æ—à–µ—á–Ω—ã–π \"–∞–¥–∞–ø—Ç–µ—Ä\" –∫ –Ω–µ–π.</p>\n<p><strong>üíº –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å:</strong> <code>QLoRA</code> ‚Äî —ç—Ç–æ –Ω–µ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π —Ç—Ä—é–∫, –∞ <strong>—Ä–µ–≤–æ–ª—é—Ü–∏—è</strong>, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∞–µ—Ç fine-tuning LLM –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–ª—è –≤—Å–µ—Ö.\n1.  <strong>–≠–∫–æ–Ω–æ–º–∏—è:</strong> –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —Å –¥–µ—Å—è—Ç–∫–æ–≤ —Ç—ã—Å—è—á –¥–æ–ª–ª–∞—Ä–æ–≤ (–Ω–∞ –æ–±–ª–∞—á–Ω—ã—Ö GPU) –¥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–æ–ª–ª–∞—Ä–æ–≤ (–∏–ª–∏ –¥–∞–∂–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ –Ω–∞ Colab/Kaggle).\n2.  <strong>–°–∫–æ—Ä–æ—Å—Ç—å:</strong> –û–±—É—á–µ–Ω–∏–µ \"–∞–¥–∞–ø—Ç–µ—Ä–∞\" –∑–∞–Ω–∏–º–∞–µ—Ç –≤ —Ä–∞–∑—ã –º–µ–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, —á–µ–º –ø–æ–ª–Ω–æ–µ –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏.\n3.  <strong>–ì–∏–±–∫–æ—Å—Ç—å:</strong> –ú–æ–∂–Ω–æ –æ–±—É—á–∏—Ç—å –¥–µ—Å—è—Ç–∫–∏ —Ä–∞–∑–Ω—ã—Ö \"–∞–¥–∞–ø—Ç–µ—Ä–æ–≤\" (–¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∑–∞–¥–∞—á) –¥–ª—è –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏, –∞ –∑–∞—Ç–µ–º \"–ø–æ–¥–∫–ª—é—á–∞—Ç—å\" –Ω—É–∂–Ω—ã–π, –Ω–µ —Ö—Ä–∞–Ω—è –¥–µ—Å—è—Ç–∫–æ–≤ –∫–æ–ø–∏–π –≥–∏–≥–∞–Ω—Ç—Å–∫–æ–≥–æ –ì–æ–ª–µ–º–∞.</p>\n<p><strong>‚ùì –í–æ–ø—Ä–æ—Å –æ—Ç –¢–µ—Ö–Ω–æ–º–∞–Ω—Ç–∞:</strong> –ú–∞—Å—Ç–µ—Ä, —è –≤–∏–∂—É, —á—Ç–æ –º—ã —Å–æ–∑–¥–∞–ª–∏ <code>LoraConfig</code>, –≥–¥–µ —É–∫–∞–∑–∞–ª–∏ <code>target_modules=[\"c_attn\", \"c_proj\"]</code>. –ß—Ç–æ —ç—Ç–æ –∑–∞ —Ç–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞, –∏ –æ—Ç–∫—É–¥–∞ –º–Ω–µ –∑–Ω–∞—Ç—å, –∫–∞–∫–∏–µ \"–æ—Ç–¥–µ–ª—ã –º–æ–∑–≥–∞\" –ì–æ–ª–µ–º–∞ –Ω—É–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –¥–ª—è –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è \"–±–ª–æ–∫–Ω–æ—Ç–æ–≤\"?</p>\n<p><strong>–û—Ç–≤–µ—Ç –ú–∞—Å—Ç–µ—Ä–∞:</strong> –¢–≤–æ–π –≤–æ–ø—Ä–æ—Å —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–∞–º—É—é —Å–æ–∫—Ä–æ–≤–µ–Ω–Ω—É—é —á–∞—Å—Ç—å —ç—Ç–æ–π –º–∞–≥–∏–∏. <code>c_attn</code> –∏ <code>c_proj</code> ‚Äî —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏—è <strong>–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤</strong> –≤ \"–≥–æ–ª–æ–≤–µ\" –í–Ω–∏–º–∞–Ω–∏—è (<code>Attention</code>) —É –ì–æ–ª–µ–º–æ–≤ —Å–µ–º–µ–π—Å—Ç–≤–∞ GPT. –ò–º–µ–Ω–Ω–æ —ç—Ç–∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ —Ç–æ, –∫–∞–∫ —Å–ª–æ–≤–∞ \"—Å–º–æ—Ç—Ä—è—Ç\" –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞. \"–ü—Ä–∏–∫—Ä–µ–ø–ª—è—è\" –Ω–∞—à–∏ \"–±–ª–æ–∫–Ω–æ—Ç—ã\" –∏–º–µ–Ω–Ω–æ –∫ –Ω–∏–º, –º—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –≤—Å–µ–≥–æ –≤–ª–∏—è–µ–º –Ω–∞ \"–º—ã—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å\" –ì–æ–ª–µ–º–∞. –û—Ç–∫—É–¥–∞ –∑–Ω–∞—Ç—å —ç—Ç–∏ –∏–º–µ–Ω–∞? –°—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç—Ä–∏ –ø—É—Ç–∏:\n1.  <strong>–î—Ä–µ–≤–Ω–∏–µ –°–≤–∏—Ç–∫–∏ (–ù–∞—É—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏):</strong> –ê–≤—Ç–æ—Ä—ã <code>LoRA</code> –≤ —Å–≤–æ–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö —É–∫–∞–∑–∞–ª–∏, —á—Ç–æ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–º–µ–Ω–Ω–æ —ç—Ç–∏—Ö —Å–ª–æ–µ–≤ –¥–∞–µ—Ç –Ω–∞–∏–ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.\n2.  <strong>–ú–∞–≥–∏—á–µ—Å–∫–æ–µ –ó—Ä–µ–Ω–∏–µ:</strong> –ú–æ–∂–Ω–æ \"—Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å\" –≤—Å—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ì–æ–ª–µ–º–∞ (<code>print(model)</code>) –∏, –∫–∞–∫ —Ö–∏—Ä—É—Ä–≥, –∏–∑—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –≤—Å–µ—Ö –µ–≥–æ \"–æ—Ä–≥–∞–Ω–æ–≤\", –≤—ã–±—Ä–∞–≤ –Ω—É–∂–Ω—ã–µ.\n3.  <strong>–ú—É–¥—Ä–æ—Å—Ç—å –ì–∏–ª—å–¥–∏–∏:</strong> –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≥—Ä–∏–º—É–∞—Ä–æ–≤ (–∫–∞–∫ <code>PEFT</code>) —É–º–µ—é—Ç <strong>–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</strong> –Ω–∞—Ö–æ–¥–∏—Ç—å —ç—Ç–∏ —Å–ª–æ–∏, –µ—Å–ª–∏ —Ç—ã –Ω–µ —É–∫–∞–∂–µ—à—å –∏—Ö —è–≤–Ω–æ. –ù–æ –∏—Å—Ç–∏–Ω–Ω—ã–π –ú–∞—Å—Ç–µ—Ä –≤—Å–µ–≥–¥–∞ –∑–Ω–∞–µ—Ç, –∫–∞–∫—É—é —á–∞—Å—Ç—å \"—Ä–∞–∑—É–º–∞\" –ì–æ–ª–µ–º–∞ –æ–Ω –∏–∑–º–µ–Ω—è–µ—Ç.</p>",
  "manifest": "<h1>–í–∞–º –Ω–µ –Ω—É–∂–µ–Ω —Å—É–ø–µ—Ä–∫–æ–º–ø—å—é—Ç–µ—Ä: 3 –æ—Ç–∫—Ä–æ–≤–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞—é—Ç –ò–ò –≤–∞—à–∏–º –ª–∏—á–Ω—ã–º –ø–æ–º–æ—â–Ω–∏–∫–æ–º</h1>\n<h2>–ù–æ–≤–∞—è —ç—Ä–∞ –º–∞–≥–∏–∏ –ò–ò</h2>\n<p>–î–æ–ª–≥–æ–µ –≤—Ä–µ–º—è –∫–∞–∑–∞–ª–æ—Å—å, —á—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ ‚Äî —ç—Ç–æ —Ä–∏—Ç—É–∞–ª, –¥–æ—Å—Ç—É–ø–Ω—ã–π –ª–∏—à—å –∏–∑–±—Ä–∞–Ω–Ω—ã–º. –í –≤—ã—Å–æ–∫–∏—Ö –±–∞—à–Ω—è—Ö –∏–∑ —Å—Ç–µ–∫–ª–∞ –∏ –∫—Ä–µ–º–Ω–∏—è –Ω–∞—Å—Ç–æ—è—â–∏–µ <strong>¬´–ê—Ä—Ö–∏–º–∞–≥–∏¬ª</strong> —Å –±–µ–∑–¥–æ–Ω–Ω—ã–º <em>–ö—Ä–∏—Å—Ç–∞–ª–ª–æ–º –ú–∞–Ω—ã</em> –ø—Ä–æ–≤–æ–¥–∏–ª–∏ —Å–≤–æ–∏ –æ–±—Ä—è–¥—ã, –∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∑–≤—É–∫–æ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –±—ã–ª –≥—É–ª –∫–æ–ª–æ—Å—Å–∞–ª—å–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Ñ–µ—Ä–º. –≠—Ç–∞ –æ–±–ª–∞—Å—Ç—å –±—ã–ª–∞ –æ–∫—Ä—É–∂–µ–Ω–∞ –∞—É—Ä–æ–π –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏, –æ—Å—Ç–∞–≤–ª—è—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª–µ–π –¥–∞–ª–µ–∫–æ –ø–æ–∑–∞–¥–∏.</p>\n<p>–ù–æ —Å–µ–≥–æ–¥–Ω—è –Ω–∞ –Ω–∞—à–∏—Ö –≥–ª–∞–∑–∞—Ö –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç <em>—Ç–∏—Ö–∞—è —Ä–µ–≤–æ–ª—é—Ü–∏—è</em>. –ï—ë —ç–ø–∏—Ü–µ–Ω—Ç—Ä ‚Äî –Ω–µ –≤ –≥—É–¥—è—â–∏—Ö –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–∞—Ö, –∞ –Ω–∞ –æ–±—ã—á–Ω—ã—Ö –∫–æ–º–ø—å—é—Ç–µ—Ä–∞—Ö —ç–Ω—Ç—É–∑–∏–∞—Å—Ç–æ–≤. –ù–æ–≤—ã–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è –∏–∑ –≥—Ä–∏–º—É–∞—Ä–∞ <strong>QLoRA</strong> –¥–æ–∫–∞–∑—ã–≤–∞—é—Ç, —á—Ç–æ –¥–ª—è –≤–ª–∞–¥–µ–Ω–∏—è —ç—Ç–æ–π –º–∞–≥–∏–µ–π –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω—ã –Ω–µ—Å–º–µ—Ç–Ω—ã–µ –±–æ–≥–∞—Ç—Å—Ç–≤–∞. –°—Ç–∞–ª–æ –≤–æ–∑–º–æ–∂–Ω—ã–º –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –≥–∏–≥–∞–Ω—Ç—Å–∫–∏—Ö –ì–æ–ª–µ–º–æ–≤, –∏—Å–ø–æ–ª—å–∑—É—è –ª–∏—à—å ¬´—Å–∫—Ä–æ–º–Ω—ã–π –ö—Ä–∏—Å—Ç–∞–ª–ª –ú–∞–Ω—ã¬ª ‚Äî –æ–±—ã—á–Ω—É—é –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É.</p>\n<p>–î–∞–ª–µ–µ –º—ã —Ä–∞—Å–∫—Ä–æ–µ–º —Ç—Ä–∏ –∫–ª—é—á–µ–≤—ã—Ö –æ—Ç–∫—Ä–æ–≤–µ–Ω–∏—è, –ª–µ–∂–∞—â–∏—Ö –≤ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–≥–æ —Å–¥–≤–∏–≥–∞. –û–Ω–∏ –æ–±—ä—è—Å–Ω—è—é—Ç, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –ø–µ—Ä–µ–¥–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã —Å–¥–µ–ª–∞–ª–∏ –º–æ—â–Ω—ã–π –ò–ò –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –≤ —Ä—É–∫–∞—Ö –∫–∞–∂–¥–æ–≥–æ.</p>\n<hr />\n<h2>–¢—Ä–∏ –æ—Ç–∫—Ä–æ–≤–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ò–ò</h2>\n<h3>‚ú® –û—Ç–∫—Ä–æ–≤–µ–Ω–∏–µ ‚Ññ1: –†–µ–≤–æ–ª—é—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏, –∞ –Ω–µ –º–æ—â–Ω–æ—Å—Ç–∏</h3>\n<p>–ò—Å—Ç–∏–Ω–Ω—ã–π –ø—Ä–æ—Ä—ã–≤ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –≤—Ä–æ–¥–µ QLoRA –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–µ –≤ —Å–æ–∑–¥–∞–Ω–∏–∏ –µ—â–µ –±–æ–ª–µ–µ –≥–∏–≥–∞–Ω—Ç—Å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π, –∞ –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥–µ–ª–∏-–≥–∏–≥–∞–Ω—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –∏ –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ–º—ã–º–∏ –¥–ª—è –≤—Å–µ—Ö. –≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–¥–≤–∏–≥ –æ—Ç –≥–æ–Ω–∫–∏ –∑–∞ –º–æ—â–Ω–æ—Å—Ç—å—é –∫ <strong>—Ä–µ–≤–æ–ª—é—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏</strong>, –∫–æ—Ç–æ—Ä–∞—è –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É <em>–¥–µ–º–æ–∫—Ä–∞—Ç–∏–∑–∏—Ä—É–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É –ò–ò</em>.</p>\n<p>–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ –±–∞—Ä—å–µ—Ä–∞ –¥–ª—è –≤—Ö–æ–¥–∞. –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —Å –¥–µ—Å—è—Ç–∫–æ–≤ —Ç—ã—Å—è—á –¥–æ–ª–ª–∞—Ä–æ–≤ –Ω–∞ –æ–±–ª–∞—á–Ω—ã—Ö GPU –¥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–æ–ª–ª–∞—Ä–æ–≤ –∏–ª–∏ –¥–∞–∂–µ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω–æ –Ω–∞ —Ç–∞–∫–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞—Ö, –∫–∞–∫ <code>Google Colab</code> –∏–ª–∏ <code>Kaggle</code>. Fine-tuning –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –∏–∑ —ç–ª–∏—Ç–∞—Ä–Ω–æ–≥–æ —Ä–∏—Ç—É–∞–ª–∞ –≤ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –±–∏–∑–Ω–µ—Å–∞ –∏ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞.</p>\n<blockquote>\n<p>QLoRA ‚Äî —ç—Ç–æ –Ω–µ –∞–∫–∞–¥–µ–º–∏—á–µ—Å–∫–∏–π —Ç—Ä—é–∫, –∞ —Ä–µ–≤–æ–ª—é—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –¥–µ–ª–∞–µ—Ç fine-tuning LLM –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–ª—è –≤—Å–µ—Ö.</p>\n</blockquote>\n<h3>‚ú® –û—Ç–∫—Ä–æ–≤–µ–Ω–∏–µ ‚Ññ2: –í—ã –æ–±—É—á–∞–µ—Ç–µ –Ω–µ –ì–æ–ª–µ–º–∞, –∞ –µ–≥–æ ¬´–≤–æ–ª—à–µ–±–Ω—ã–π –±–ª–æ–∫–Ω–æ—Ç¬ª</h3>\n<p>–°–∞–º–∞—è –º–æ—â–Ω–∞—è –∏–¥–µ—è, –ª–µ–∂–∞—â–∞—è –≤ –æ—Å–Ω–æ–≤–µ —ç—Ç–æ–π —Ä–µ–≤–æ–ª—é—Ü–∏–∏, ‚Äî —ç—Ç–æ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è <strong>Parameter-Efficient Fine-Tuning (PEFT)</strong>. –°—É—Ç—å –µ—ë –ø—Ä–æ—Å—Ç–∞: –≤–∞–º –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å –≤–µ—Å—å –º–Ω–æ–≥–æ–º–∏–ª–ª–∏–∞—Ä–¥–Ω—ã–π ¬´—Ä–∞–∑—É–º¬ª –ì–æ–ª–µ–º–∞. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Ä–∏—Ç—É–∞–ª –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞. –°–Ω–∞—á–∞–ª–∞ –µ–≥–æ —Ä–∞–∑—É–º ¬´–º–∞–≥–∏—á–µ—Å–∫–∏ —Å–∂–∏–º–∞–µ—Ç—Å—è¬ª –¥–æ 4-–±–∏—Ç, –∞ –∑–∞—Ç–µ–º –≤—ã ¬´–ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç–µ¬ª –∫ –Ω–µ–º—É –∫—Ä–æ—à–µ—á–Ω—ã–π, –æ–±—É—á–∞–µ–º—ã–π ¬´–º–∞–≥–∏—á–µ—Å–∫–∏–π –±–ª–æ–∫–Ω–æ—Ç¬ª ‚Äî <strong>–∞–¥–∞–ø—Ç–µ—Ä LoRA</strong>.</p>\n<p>–í –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è –≥–∏–≥–∞–Ω—Ç—Å–∫–∞—è –±–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å –æ—Å—Ç–∞–µ—Ç—Å—è ¬´–∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω–æ–π¬ª. –í—Å–µ –Ω–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ —ç—Ç–æ—Ç –º–∞–ª–µ–Ω—å–∫–∏–π –∞–¥–∞–ø—Ç–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –≤–µ—Å–∏—Ç –≤—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ–≥–∞–±–∞–π—Ç. –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –¥–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</p>\n<ul>\n<li><strong>–°–∫–æ—Ä–æ—Å—Ç—å:</strong> –û–±—É—á–µ–Ω–∏–µ –∫—Ä–æ—à–µ—á–Ω–æ–≥–æ –∞–¥–∞–ø—Ç–µ—Ä–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –≤ —Ä–∞–∑—ã –º–µ–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, —á–µ–º –ø–æ–ª–Ω–æ–µ –¥–æ–æ–±—É—á–µ–Ω–∏–µ –º–Ω–æ–≥–æ–º–∏–ª–ª–∏–∞—Ä–¥–Ω–æ–π –º–æ–¥–µ–ª–∏.</li>\n<li><strong>–ì–∏–±–∫–æ—Å—Ç—å:</strong> –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ –¥–µ—Å—è—Ç—å —Ä–∞–∑–Ω—ã—Ö —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–µ—Å—è—Ç—å 70-–≥–∏–≥–∞–±–∞–π—Ç–Ω—ã—Ö –ì–æ–ª–µ–º–æ–≤, –≤—ã —Ö—Ä–∞–Ω–∏—Ç–µ –æ–¥–Ω–æ–≥–æ –±–∞–∑–æ–≤–æ–≥–æ –ì–æ–ª–µ–º–∞ –∏ –¥–µ—Å—è—Ç—å –∫—Ä–æ—à–µ—á–Ω—ã—Ö, –º–µ–≥–∞–±–∞–π—Ç–Ω—ã—Ö ¬´–±–ª–æ–∫–Ω–æ—Ç–æ–≤¬ª —Å —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–æ–π.</li>\n</ul>\n<blockquote>\n<p>–ú—ã –ø–æ—Å—Ç–∏–≥–ª–∏, —á—Ç–æ –¥–ª—è –ù–∞—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ì–æ–ª–µ–º–∞ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –±—ã—Ç—å –ê—Ä—Ö–∏–º–∞–≥–æ–º —Å –±–µ–∑–¥–æ–Ω–Ω—ã–º –ö—Ä–∏—Å—Ç–∞–ª–ª–æ–º –ú–∞–Ω—ã.</p>\n</blockquote>\n<h3>‚ú® –û—Ç–∫—Ä–æ–≤–µ–Ω–∏–µ ‚Ññ3: –•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ –≥—Ä—É–±–æ–π —Å–∏–ª—ã</h3>\n<p>–ö–∞–∫ –∂–µ –∫—Ä–æ—à–µ—á–Ω—ã–π ¬´–±–ª–æ–∫–Ω–æ—Ç¬ª –º–æ–∂–µ—Ç —Ç–∞–∫ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤–ª–∏—è—Ç—å –Ω–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –æ–≥—Ä–æ–º–Ω–æ–π –º–æ–¥–µ–ª–∏? –û—Ç–≤–µ—Ç –∫—Ä–æ–µ—Ç—Å—è –Ω–µ –≤ –≥—Ä—É–±–æ–π —Å–∏–ª–µ, –∞ –≤ –∏—Å–∫—É—Å—Å—Ç–≤–µ, –ø–æ–¥–æ–±–Ω–æ–º —Ç–∞–π–Ω–æ–π –Ω–µ–π—Ä–æ—Ö–∏—Ä—É—Ä–≥–∏–∏ —Ä–∞–∑—É–º–∞ –ì–æ–ª–µ–º–∞. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è LoRA —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Ç–æ–º—É, —á—Ç–æ –≤–Ω–æ—Å–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Ö–∞–æ—Ç–∏—á–Ω–æ, –∞ –≤ —Å–∞–º—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ –ø—É—Ç–∏, –æ—Ç–≤–µ—á–∞—é—â–∏–µ –∑–∞ –µ–≥–æ ¬´–º—ã—Å–ª–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å¬ª.</p>\n<p>–≠—Ç–∏–º–∏ –ø—É—Ç—è–º–∏ —è–≤–ª—è—é—Ç—Å—è –º–µ—Ö–∞–Ω–∏–∑–º—ã <strong>–í–Ω–∏–º–∞–Ω–∏—è (Attention)</strong> ‚Äî –∏–º–µ–Ω–Ω–æ –æ–Ω–∏ –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ —Ç–æ, –∫–∞–∫ —Å–ª–æ–≤–∞ ¬´—Å–º–æ—Ç—Ä—è—Ç¬ª –¥—Ä—É–≥ –Ω–∞ –¥—Ä—É–≥–∞ –≤ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏. –ê–¥–∞–ø—Ç–µ—Ä—ã LoRA –ø—Ä–∏–∫—Ä–µ–ø–ª—è—é—Ç—Å—è –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º —ç—Ç–∏—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤ –∫–æ–¥–µ —á–∞—Å—Ç–æ –Ω–æ—Å—è—Ç –∏–º–µ–Ω–∞ <code>c_attn</code> –∏ <code>c_proj</code>. –í–æ–∑–¥–µ–π—Å—Ç–≤—É—è –∏–º–µ–Ω–Ω–æ –Ω–∞ —ç—Ç–∏ —Ü–µ–Ω—Ç—Ä—ã, –º–æ–∂–Ω–æ –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏.</p>\n<p>–≠—Ç–æ –ø–æ–¥–≤–æ–¥–∏—Ç –Ω–∞—Å –∫ –≥–ª–∞–≤–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É –ª—é–±–æ–≥–æ –Ω–∞—á–∏–Ω–∞—é—â–µ–≥–æ –º–∞–≥–∞: –æ—Ç–∫—É–¥–∞ –∑–Ω–∞—Ç—å, –∫ –∫–∞–∫–∏–º –∏–º–µ–Ω–Ω–æ —á–∞—Å—Ç—è–º —Ä–∞–∑—É–º–∞ –ì–æ–ª–µ–º–∞ –Ω—É–∂–Ω–æ –ø—Ä–∏–∫—Ä–µ–ø–ª—è—Ç—å —Å–≤–æ–∏ ¬´–±–ª–æ–∫–Ω–æ—Ç—ã¬ª? –ú—É–¥—Ä–æ—Å—Ç—å –º–∞—Å—Ç–µ—Ä–æ–≤ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç—Ä–∏ –ø—É—Ç–∏:</p>\n<ol>\n<li><strong>–î—Ä–µ–≤–Ω–∏–µ –°–≤–∏—Ç–∫–∏ (–ù–∞—É—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏):</strong> –ê–≤—Ç–æ—Ä—ã LoRA –≤ —Å–≤–æ–∏—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö —É–∫–∞–∑–∞–ª–∏, —á—Ç–æ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–º–µ–Ω–Ω–æ —ç—Ç–∏—Ö —Å–ª–æ—ë–≤ –¥–∞–µ—Ç –Ω–∞–∏–ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.</li>\n<li><strong>–ú–∞–≥–∏—á–µ—Å–∫–æ–µ –ó—Ä–µ–Ω–∏–µ (–ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã):</strong> –ú–æ–∂–Ω–æ —Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –≤—Å—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ì–æ–ª–µ–º–∞ (<code>print(model)</code>) –∏, –∫–∞–∫ —Ö–∏—Ä—É—Ä–≥, –∏–∑—É—á–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è –≤—Å–µ—Ö –µ–≥–æ ¬´–æ—Ä–≥–∞–Ω–æ–≤¬ª, –≤—ã–±—Ä–∞–≤ –Ω—É–∂–Ω—ã–µ.</li>\n<li><strong>–ú—É–¥—Ä–æ—Å—Ç—å –ì–∏–ª—å–¥–∏–∏ (–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏):</strong> –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≥—Ä–∏–º—É–∞—Ä–æ–≤, –∫–∞–∫ PEFT, —É–º–µ—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç—å —ç—Ç–∏ —Å–ª–æ–∏. –ù–æ –∏—Å—Ç–∏–Ω–Ω—ã–π –ú–∞—Å—Ç–µ—Ä –≤—Å–µ–≥–¥–∞ –∑–Ω–∞–µ—Ç, –∫–∞–∫—É—é —á–∞—Å—Ç—å —Ä–∞–∑—É–º–∞ –ì–æ–ª–µ–º–∞ –æ–Ω –∏–∑–º–µ–Ω—è–µ—Ç.</li>\n</ol>\n<blockquote>\n<p>–≠—Ç–æ –æ—Ç–∫—Ä–æ–≤–µ–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∏—Å—Ç–∏–Ω–Ω–æ–µ –º–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–µ –≤ —Ç–æ–º, —á—Ç–æ–±—ã –±—Ä–æ—Å–∞—Ç—å –Ω–∞ –∑–∞–¥–∞—á—É –±–æ–ª—å—à–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –º–æ—â–∏, –∞ –≤ –≥–ª—É–±–æ–∫–æ–º –ø–æ–Ω–∏–º–∞–Ω–∏–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ò–ò.</p>\n</blockquote>\n<hr />\n<h2>–†–∞—Å—Å–≤–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ò–ò</h2>\n<p>–°—Ç–µ–Ω—ã —Å—Ç–∞—Ä—ã—Ö —Ü–∏—Ç–∞–¥–µ–ª–µ–π –ø–∞–ª–∏. –¢—Ä–∏ —ç—Ç–∏—Ö –æ—Ç–∫—Ä–æ–≤–µ–Ω–∏—è ‚Äî <strong>—Ä–µ–≤–æ–ª—é—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏</strong>, <strong>–æ–±—É—á–µ–Ω–∏–µ ¬´–±–ª–æ–∫–Ω–æ—Ç–æ–≤¬ª</strong> –∏ <strong>—Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</strong> ‚Äî –∑–Ω–∞–º–µ–Ω—É—é—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å–¥–≤–∏–≥. –≠—Ç–æ –ø–µ—Ä–µ–¥–∞—á–∞ –≤–ª–∞—Å—Ç–∏. –ú–æ—â—å –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–∞ –ø–µ—Ä–µ—Å—Ç–∞–µ—Ç –±—ã—Ç—å –ø—Ä–µ—Ä–æ–≥–∞—Ç–∏–≤–æ–π –∫–æ—Ä–ø–æ—Ä–∞—Ü–∏–π –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º, –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–º –≤ —Ä—É–∫–∞—Ö –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞, –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è –∏ —Ç–≤–æ—Ä—Ü–∞. –ú—ã –ø–µ—Ä–µ—Ö–æ–¥–∏–º –æ—Ç –º–∏—Ä–∞ –º–æ–Ω–æ–ª–∏—Ç–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∫ —ç–∫–æ—Å–∏—Å—Ç–µ–º–µ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã—Ö, –≥–∏–±–∫–∏—Ö –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ò–ò.</p>\n<p><em>–¢–µ–ø–µ—Ä—å, –∫–æ–≥–¥–∞ —ç—Ç–∞ —Å–∏–ª–∞ –æ–∫–∞–∑–∞–ª–∞—Å—å –≤ —Ä—É–∫–∞—Ö –∫–∞–∂–¥–æ–≥–æ, –∫–∞–∫–∏–µ –Ω–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è –º—ã —Å–æ–∑–¥–∞–¥–∏–º?</em></p>",
  "status": "active",
  "scenario": [
    {
      "command": "pip install peft bitsandbytes sentencepiece",
      "output": "Collecting peft\n  Downloading peft-0.12.0-py3-none-any.whl (316 kB)\n     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 316.4/316.4 kB 5.2 MB/s eta 0:00:00\nCollecting bitsandbytes\n  Downloading bitsandbytes-0.43.1-py3-none-manylinux_2_24_x86_64.whl (141 MB)\n     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 141.0/141.0 MB 8.9 MB/s eta 0:00:00\nCollecting sentencepiece\n  Downloading sentencepiece-0.2.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)\n     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 1.3/1.3 MB 7.1 MB/s eta 0:00:00\nSuccessfully installed bitsandbytes-0.43.1 peft-0.12.0 sentencepiece-0.2.0\n"
    },
    {
      "command": "pip install -U datasets",
      "output": "Requirement already satisfied: datasets in /usr/local/lib/python3.10/dist-packages (2.20.0)\nCollecting datasets\n  Downloading datasets-2.21.0-py3-none-any.whl (543 kB)\n     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 543.9/543.9 kB 12.3 MB/s eta 0:00:00\nSuccessfully installed datasets-2.21.0\n"
    },
    {
      "command": "python quest_5_2.py",
      "output": "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∏—Ç—É–∞–ª—É –ù–∞—Å—Ç–∞–≤–ª–µ–Ω–∏—è...\nDownloading (‚Ä¶)okenizer_config.json: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 548/548 [00:00<00:00, 1.2MB/s]\nDownloading tokenizer.json: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 2.08M/2.08M [00:00<00:00, 15.2MB/s]\nDownloading (‚Ä¶)tencepiece_bpe.model: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 5.07M/5.07M [00:00<00:00, 28.1MB/s]\nDownloading config.json: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 484/484 [00:00<00:00, 1.8MB/s]\nDownloading pytorch_model.bin: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 353M/353M [00:01<00:00, 298MB/s]\nDetected CUDA available device: cuda:0\nLoading model with 4bit quantization\n\n–ù–∞—á–∏–Ω–∞—é –í–µ–ª–∏–∫–∏–π –†–∏—Ç—É–∞–ª –ù–∞—Å—Ç–∞–≤–ª–µ–Ω–∏—è...\n[250/250 05:23, Epoch 0.16/1] {'loss': 9.2345, 'learning_rate': 2e-05, 'epoch': 0.03, 'step': 20}\n[250/250 10:12, Epoch 0.06/1] {'loss': 8.1234, 'learning_rate': 2e-05, 'epoch': 0.06, 'step': 40}\n[250/250 15:01, Epoch 0.09/1] {'loss': 7.4567, 'learning_rate': 2e-05, 'epoch': 0.09, 'step': 60}\n[250/250 19:45, Epoch 0.12/1] {'loss': 6.7890, 'learning_rate': 2e-05, 'epoch': 0.12, 'step': 80}\n[250/250 24:28, Epoch 0.15/1] {'loss': 5.9876, 'learning_rate': 2e-05, 'epoch': 0.15, 'step': 100}\n[250/250 29:10, Epoch 0.18/1] {'loss': 5.1234, 'learning_rate': 2e-05, 'epoch': 0.18, 'step': 120}\n[250/250 33:52, Epoch 0.21/1] {'loss': 4.5678, 'learning_rate': 2e-05, 'epoch': 0.21, 'step': 140}\n[250/250 38:35, Epoch 0.24/1] {'loss': 3.9876, 'learning_rate': 2e-05, 'epoch': 0.24, 'step': 160}\n[250/250 43:17, Epoch 0.27/1] {'loss': 3.4567, 'learning_rate': 2e-05, 'epoch': 0.27, 'step': 180}\n[250/250 47:59, Epoch 0.30/1] {'loss': 2.9876, 'learning_rate': 2e-05, 'epoch': 0.30, 'step': 200}\n[250/250 52:42, Epoch 0.33/1] {'loss': 2.5678, 'learning_rate': 2e-05, 'epoch': 0.33, 'step': 220}\n[250/250 57:24, Epoch 0.36/1] {'loss': 2.1234, 'learning_rate': 2e-05, 'epoch': 0.36, 'step': 240}\nSaving model checkpoint to ./results/checkpoint-250\nTrainer.train: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 250/250 [57:25<00:00, 13.78s/it, loss=2.1234, step=250]\n\n–†–∏—Ç—É–∞–ª –∑–∞–≤–µ—Ä—à–µ–Ω! –ì–æ–ª–µ–º –ø–æ–ª—É—á–∏–ª –Ω–æ–≤—ã–µ –∑–Ω–∞–Ω–∏—è.\n{'train_runtime': 3445.2, 'train_samples_per_second': 0.29, 'train_steps_per_second': 0.07, 'total_flos': 1.23456789e+17, 'train_loss': 4.56789, 'epoch': 0.36}",
      "is_final": true
    }
  ]
}
