# Мастерская Духа-Архивариуса (`rag_builder`)

Эта мастерская содержит священный ритуал `rag_builder.py`, предназначенный для сотворения Духа-Архивариуса — сущности, что готовит всю текстовую мудрость Великого Кодекса для Оракула NotebookLM.

Скрипт рекурсивно обходит Кодекс, собирая пергаменты (`.py`, `.md`, `.yaml` и т.д.) и преобразуя их в канонические PDF-тома, которыми будет питаться Оракул.

## Философия «Живой Летописи»

Ритуал следует стратегии инкрементального обновления, чтобы минимизировать ручные операции с Оракулом:

1.  **Архивные Тома (`part_N.pdf`)**: Когда мудрости накапливается достаточно, чтобы превысить лимит (~475,000 слов), создается запечатанный, неизменный том. Его следует загрузить в NotebookLM **один раз и более не трогать**.

2.  **Активный Том (`living_chronicle.pdf`)**: Вся новая и измененная мудрость всегда сохраняется в этот специальный том. При каждом запуске ритуала он пересоздается. В NotebookLM достаточно **удалить и заново загрузить только этот один источник**.

## Ритуал Подготовки Алтаря (Единоразово)

Прежде чем начать, нужно подготовить мастерскую.

```bash
# 1. Войдите в мастерскую
cd tools/rag_builder

# 2. Активируйте ваше магическое поле «Тайного Круга»
# (Предполагается, что оно уже сотворено)
conda activate arcane_circle

# 3. Призовите Духа-Каллиграфа (установите зависимости)
pip install -r requirements.txt

# 4. Призовите Ингредиенты от Хранителя DVC
# Эта команда материализует шрифт DejaVuSans.ttf
dvc pull
```

## Проведение Ритуала Сотворения

Каждый раз, когда Кодекс обновляется, проводите этот ритуал для обновления PDF-томов.

```bash
# 1. Убедитесь, что ваше магическое поле «arcane_circle» активно.

# 2. Запустите пергамент
python rag_builder.py
```

## Результаты Ритуала

После успешного завершения Хранитель DVC будет владеть следующими артефактами в этой папке:

- **`notebooklm_sources/`**: Папка с PDF-томами (`part_1.pdf`, `living_chronicle.pdf`).
- **`manifest.json`**: Файл-душа, описывающий состояние томов.
- **`DejaVuSans.ttf`**: Рунический шрифт, необходимый для ритуала.
