"""–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏: –î–µ—Ç–µ–∫—Ç–∏–≤ –í—Ä–µ–º–µ–Ω–Ω—ã—Ö –ü–∞—Ä–∞–¥–æ–∫—Å–æ–≤.

–≠—Ç–æ—Ç –ø–µ—Ä–≥–∞–º–µ–Ω—Ç ‚Äî "–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ú–∞—Å—Ç–µ—Ä–∞", –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞—É–¥–∏—Ç–∞
–õ–µ—Ç–æ–ø–∏—Å–∏ (`manifest.json`). –ï–≥–æ —Ü–µ–ª—å ‚Äî –Ω–∞–π—Ç–∏ "–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–¥–æ–∫—Å—ã": —Ñ–∞–π–ª—ã,
–∫–æ—Ç–æ—Ä—ã–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–µ—Ä—Å–∏—è—Ö –≤ —Ä–∞–∑–Ω—ã—Ö PDF-—Ç–æ–º–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤
–∑–∞–ø–µ—á–∞—Ç–∞–Ω–Ω–æ–º `part_1.pdf` –∏ –≤ –∞–∫—Ç–∏–≤–Ω–æ–º `living_chronicle.pdf`).

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—è–≤–∏—Ç—å –∏–¥–µ–∞–ª—å–Ω—ã—Ö "–∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤" –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
–û—Ä–∞–∫—É–ª–∞-–ê—Ä—Ö–∏–≤–∞—Ä–∏—É—Å–∞ (RAG-—Å–∏—Å—Ç–µ–º—ã) —Ä–∞–∑—Ä–µ—à–∞—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–µ—Ä—Å–∏–π –∏ –æ—Ç–ª–∏—á–∞—Ç—å
—É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∑–Ω–∞–Ω–∏—è –æ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö.
"""

# –ü—Ä–∏–∑—ã–≤–∞–µ–º –¥—É—Ö–∞ —Ñ–æ—Ä–º–∞—Ç–∞ JSON –¥–ª—è —á—Ç–µ–Ω–∏—è –õ–µ—Ç–æ–ø–∏—Å–∏.
import json

# --- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –†–∏—Ç—É–∞–ª–∞ ---
# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ò—Å—Ç–∏–Ω–Ω–æ–µ –ò–º—è —Ñ–∞–π–ª–∞-–õ–µ—Ç–æ–ø–∏—Å–∏, –∫–æ—Ç–æ—Ä—ã–π –º—ã –±—É–¥–µ–º –∏–∑—É—á–∞—Ç—å.
MANIFEST_FILE = "manifest.json"


# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≥–ª–∞–≤–Ω—ã–π —Ä–∏—Ç—É–∞–ª "–ü–æ–∏—Å–∫–∞ –í—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –ü–∞—Ä–∞–¥–æ–∫—Å–∞".
def find_version_paradox():
    """–ù–∞—Ö–æ–¥–∏—Ç –∏ –≤—ã–≤–æ–¥–∏—Ç —Ñ–∞–π–ª—ã, –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–æ–º–∞—Ö –õ–µ—Ç–æ–ø–∏—Å–∏."""

    # –û–±—ä—è–≤–ª—è–µ–º –æ –Ω–∞—á–∞–ª–µ —Ä–∏—Ç—É–∞–ª–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏.
    print("--- –ó–ê–ü–£–°–ö –î–ï–¢–ï–ö–¢–ò–í–ê –í–†–ï–ú–ï–ù–ù–´–• –ü–ê–†–ê–î–û–ö–°–û–í ---")

    # –ù–∞—á–∏–Ω–∞–µ–º —Ä–∏—Ç—É–∞–ª –ø–æ–¥ –∑–∞—â–∏—Ç–æ–π –æ—Ö—Ä–∞–Ω–Ω—ã—Ö —Ä—É–Ω –Ω–∞ —Å–ª—É—á–∞–π –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –õ–µ—Ç–æ–ø–∏—Å–∏.
    try:
        # –û—Ç–∫—Ä—ã–≤–∞–µ–º —Å–≤–∏—Ç–æ–∫ –õ–µ—Ç–æ–ø–∏—Å–∏ –¥–ª—è —á—Ç–µ–Ω–∏—è —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π UTF-8.
        with open(MANIFEST_FILE, "r", encoding="utf-8") as f:
            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ç–µ–∫—Å—Ç —Å–≤–∏—Ç–∫–∞ –∏–∑ JSON –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö.
            data = json.load(f)
    # –ï—Å–ª–∏ –õ–µ—Ç–æ–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞...
    except FileNotFoundError:
        # ...—Å–æ–æ–±—â–∞–µ–º –æ–± –æ—à–∏–±–∫–µ –∏ –ø—Ä–µ—Ä—ã–≤–∞–µ–º —Ä–∏—Ç—É–∞–ª.
        print(f"‚ùå –û—à–∏–±–∫–∞: {MANIFEST_FILE} –Ω–µ –Ω–∞–π–¥–µ–Ω!")
        # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é.
        return

    # –ò–∑–≤–ª–µ–∫–∞–µ–º –∏–∑ –õ–µ—Ç–æ–ø–∏—Å–∏ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö "—Ç–æ–º–æ–≤" (chunks),
    # –∏–ª–∏ –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç.
    chunks = data.get("chunks", [])
    # –ï—Å–ª–∏ —Ç–æ–º–æ–≤ –º–µ–Ω—å—à–µ –¥–≤—É—Ö, —Ç–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç –≤–µ—Ä—Å–∏–π –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω.
    if len(chunks) < 2:
        # –°–æ–æ–±—â–∞–µ–º –æ–± —ç—Ç–æ–º –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º —Ä–∏—Ç—É–∞–ª.
        print("‚ÑπÔ∏è –ù–∞–π–¥–µ–Ω–æ –º–µ–Ω—å—à–µ –¥–≤—É—Ö —Ç–æ–º–æ–≤. –ü–∞—Ä–∞–¥–æ–∫—Å—ã –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã.")
        # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é.
        return

    # --- –§–∞–∑–∞ 1: –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ –¢–æ–º–∞–º ---
    # –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤ –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –∞—Ä—Ö–∏–≤–Ω–æ–≥–æ —Ç–æ–º–∞.
    part_1_sources = set()
    # –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤ –∏–∑ "–∂–∏–≤–æ–≥–æ" —Ç–æ–º–∞.
    living_chronicle_sources = set()

    # –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –≤—Å–µ "—Ç–æ–º–∞", –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –≤ –õ–µ—Ç–æ–ø–∏—Å–∏.
    for chunk in chunks:
        # –ò–∑–≤–ª–µ–∫–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞ —Ç–æ–º–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "part_1.pdf").
        file_name = chunk.get("file")
        # –ò–∑–≤–ª–µ–∫–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–ª—è —ç—Ç–æ–≥–æ —Ç–æ–º–∞.
        sources = chunk.get("sources", [])

        # –ï—Å–ª–∏ –∏–º—è —Ç–æ–º–∞ - "part_1.pdf"...
        if file_name == "part_1.pdf":
            # ...—Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤ –Ω–∞—à–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ.
            part_1_sources = set(sources)
            # –°–æ–æ–±—â–∞–µ–º –æ–± —É—Å–ø–µ—Ö–µ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.
            print(f"‚úÖ –ù–∞–π–¥–µ–Ω 'part_1.pdf', —Å–æ–¥–µ—Ä–∂–∏—Ç {len(part_1_sources)} —Ñ–∞–π–ª–æ–≤.")

        # –ï—Å–ª–∏ –∏–º—è —Ç–æ–º–∞ - "living_chronicle.pdf"...
        elif file_name == "living_chronicle.pdf":
            # ...—Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –º–Ω–æ–∂–µ—Å—Ç–≤–æ.
            living_chronicle_sources = set(sources)
            # –°–æ–æ–±—â–∞–µ–º –æ–± —É—Å–ø–µ—Ö–µ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.
            print(
                "‚úÖ –ù–∞–π–¥–µ–Ω 'living_chronicle.pdf', "
                f"—Å–æ–¥–µ—Ä–∂–∏—Ç {len(living_chronicle_sources)} —Ñ–∞–π–ª–æ–≤."
            )

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É–¥–∞–ª–æ—Å—å –ª–∏ –Ω–∞–º –Ω–∞–π—Ç–∏ –æ–±–∞ –Ω—É–∂–Ω—ã—Ö —Ç–æ–º–∞.
    if not part_1_sources or not living_chronicle_sources:
        # –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —Å–æ–æ–±—â–∞–µ–º –æ–± —ç—Ç–æ–º.
        print(
            "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ –æ–±–∞ —Ç–æ–º–∞ ('part_1.pdf' –∏ "
            "'living_chronicle.pdf') –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ."
        )
        # –ó–∞–≤–µ—Ä—à–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é.
        return

    # --- –§–∞–∑–∞ 2: –ü–æ–∏—Å–∫ –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π –∏ –í–µ—Ä–¥–∏–∫—Ç ---
    # –ù–∞—Ö–æ–¥–∏–º —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –æ–±–æ–∏—Ö –º–Ω–æ–∂–µ—Å—Ç–≤–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
    paradox_files = part_1_sources.intersection(living_chronicle_sources)

    # –í—ã–≤–æ–¥–∏–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
    print("\n--- –†–ï–ó–£–õ–¨–¢–ê–¢–´ ---")
    # –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Ñ–∞–π–ª—ã, —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤ –æ–±–µ–∏—Ö –≤–µ—Ä—Å–∏—è—Ö...
    if paradox_files:
        # ...–æ–±—ä—è–≤–ª—è–µ–º –æ–± –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–¥–æ–∫—Å–æ–≤.
        print(
            f"üí• –û–ë–ù–ê–†–£–ñ–ï–ù–´ –í–†–ï–ú–ï–ù–ù–´–ï –ü–ê–†–ê–î–û–ö–°–´! "
            f"–≠—Ç–∏ {len(paradox_files)} —Ñ–∞–π–ª–∞ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ —Ä–∞–∑–Ω—ã—Ö –≤–µ—Ä—Å–∏—è—Ö:"
        )
        # –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –≤—ã–≤–æ–¥–∞.
        for file_path in sorted(list(paradox_files)):
            # –ü–µ—á–∞—Ç–∞–µ–º –ø—É—Ç—å –∫ –∫–∞–∂–¥–æ–º—É —Ñ–∞–π–ª—É-–ø–∞—Ä–∞–¥–æ–∫—Å—É.
            print(f"  - {file_path}")
        # –î–∞–µ–º –ú–∞–≥—É-–¢–µ—Ö–Ω–æ–º–∞–Ω—Ç—É –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –∫ –¥–µ–π—Å—Ç–≤–∏—é.
        print("\n–ò—Å–ø–æ–ª—å–∑—É–π –ª—é–±–æ–π –∏–∑ —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –û—Ä–∞–∫—É–ª–∞.")
    # –ï—Å–ª–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ...
    else:
        # ...—Å–æ–æ–±—â–∞–µ–º, —á—Ç–æ –õ–µ—Ç–æ–ø–∏—Å—å —Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —á–∏—Å—Ç–∞.
        print(
            "‚ú® –ü–∞—Ä–∞–¥–æ–∫—Å–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –í—Å–µ —Ñ–∞–π–ª—ã –≤ 'living_chronicle.pdf' "
            "—É–Ω–∏–∫–∞–ª—å–Ω—ã –¥–ª—è —ç—Ç–æ–≥–æ —Ç–æ–º–∞."
        )
        # –û–±—ä—è—Å–Ω—è–µ–º, —á—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç.
        print(
            "   –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –Ω–∏ –æ–¥–∏–Ω –∏–∑ —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤, "
            "–ø–æ–ø–∞–≤—à–∏—Ö –≤ part_1, –Ω–µ –∏–∑–º–µ–Ω—è–ª—Å—è."
        )


# –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –ø–µ—Ä–≥–∞–º–µ–Ω—Ç –ø—Ä–∏–∑–≤–∞–Ω –Ω–∞–ø—Ä—è–º—É—é –∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é.
if __name__ == "__main__":
    # –ó–∞–ø—É—Å–∫–∞–µ–º –≥–ª–∞–≤–Ω—ã–π —Ä–∏—Ç—É–∞–ª –ø–æ–∏—Å–∫–∞ –ø–∞—Ä–∞–¥–æ–∫—Å–æ–≤.
    find_version_paradox()
