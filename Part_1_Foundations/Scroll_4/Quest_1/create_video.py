"""Часть Ритуала для Квеста 4.1 - Сотворение Артефакта.

Этот пергамент не является самостоятельным Квестом. Его единственная цель
(МАКРО-контекст) — создать "магическую кинопленку" (`test_video.mp4`),
которая станет объектом исследования в Квесте 4.1.

Ритуал берет статичное изображение, и с помощью
гримуара `OpenCV` (`cv2`) многократно записывает его как последовательность
кадров в новый видеофайл. Это — подготовительный акт, необходимый для
основного ритуала деконструкции видео.
"""

# --- Часть I: Импорт Магических Гримуаров ---
# Первый раздел: мы призываем все необходимые знания и инструменты.
# Мы призываем `cv2` (OpenCV) — "Набор Кинематографиста" для работы с видео.
import cv2

# --- Часть II: Ритуал Творения Кинопленки ---
# Начинается вторая часть нашего ритуала: мы сотворим артефакт.
# Мы оглашаем на кристалл (консоль) о начале ритуала творения.
print("--- Ритуал Творения Кинопленки ---")

# Мы загружаем нашего "Актера" — артефакт из Свитка 3.
img = cv2.imread("magical_cat.png")
# Мы проверяем, был ли "актер" найден, чтобы ритуал не провалился впустую.
if img is None:
    # Если "актер" не найден, мы сообщаем об ошибке.
    print("Ошибка: Артефакт 'magical_cat.png' не найден! Пройди Свиток 3.")
    # Мы произносим заклинание 'exit()', которое немедленно останавливает
    # выполнение пергамента.
    exit()

# Мы измеряем "сцену", получая высоту, ширину и количество слоев цвета
# нашего "Актера".
height, width, _ = img.shape
# Мы создаем "мерку" для нашей кинопленки в формате (ширина, высота).
size = (width, height)

# Мы готовим "Кинопленку", давая ей каноническое имя.
video_path = "test_video.mp4"
# Мы сотворяем "объект-рекордер", который будет записывать кадры.
out = cv2.VideoWriter(video_path, cv2.VideoWriter_fourcc(*"mp4v"), 1, size)

# Мы начинаем ритуал записи, повторяя его 10 раз, чтобы создать
# 10-кадровое видео.
for _ in range(10):
    # Мы записываем нашего "Актера" как один кадр на "кинопленку".
    out.write(img)

# Мы произносим критически важное заклинание, "запечатывающее" кинопленку.
out.release()

# Мы оглашаем, что ритуал творения успешно завершен.
print(f"Магическая кинопленка '{video_path}' создана успешно.")
