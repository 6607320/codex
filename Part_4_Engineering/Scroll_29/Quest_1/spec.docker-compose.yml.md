# docker-compose.yml Specification

## 1. Meta Information

- Domain: Infrastructure
- Complexity: Medium
- Language: Bash
- Frameworks: Docker, docker-compose, Prometheus, Grafana
- Context: Independent Artifact

## 2. Goal & Purpose (–¶–µ–ª—å –∏ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ)

–ö–æ–Ω—Ç–µ–∫—Å—Ç –°–æ–∑–¥–∞—Ç–µ–ª—è: –≠—Ç–æ—Ç –†–∏—Ç—É–∞–ª –°–∫—Ä–∏–∂–∞–ª—å —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç —Ç—Ä–∏ –≥–æ–ª–µ–º–∞ –≤ –µ–¥–∏–Ω–æ–π —Ü–µ–ø–∏ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è: –û–±–ª–∞—á–Ω—ã–π –ì–æ–ª–µ–º (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ), –°—Ç—Ä–∞–∂ –ü—Ä–æ–º–µ—Ç–µ–π (Prometheus) –∏ –ü—Ä–æ–≤–∏–¥–µ—Ü —Å –•—Ä—É—Å—Ç–∞–ª—å–Ω—ã–º –ó–µ—Ä–∫–∞–ª–æ–º (Grafana). –û–Ω–æ —Å–æ–∑–¥–∞—ë—Ç —Å–æ–≤–º–µ—Å—Ç–Ω—ã–π –≠—Ñ–∏—Ä —á–µ—Ä–µ–∑ —Å–µ—Ç—å monitoring-net, –º–æ–Ω—Ç–∏—Ä—É–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤. –ó–∞—á–µ–º –Ω—É–∂–µ–Ω —ç—Ç–æ—Ç —Ñ–∞–π–ª: —É–ø–æ—Ä—è–¥–æ—á–∏—Ç—å –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ —Ä–∞–±–æ—á–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤–æ–∫—Ä—É–≥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —á—Ç–æ–±—ã –≤–∏–¥–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –º–µ—Ç—Ä–∏–∫ –±—ã–ª–æ –¥–æ—Å—Ç—É–ø–Ω–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ.

## 3. Interface Contract (–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ã–π –ö–æ–Ω—Ç—Ä–∞–∫—Ç)

Instruction: —Å—Ç—Ä–æ–≥–æ —Ä–µ–∞–ª–∏–∑—É–π —ç—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –¢ypeScript-–ø–æ–¥–æ–±–Ω—ã—Ö —Ñ–æ—Ä–º, –±–µ–∑ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π. –ù–∏–∂–µ –æ–ø–∏—Å–∞–Ω—ã —Ñ–æ—Ä–º—ã –¥–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤–∞–º–∏.

### 3.1. Inputs (–í—Ö–æ–¥—ã)

- Source: CLI Args
- Format: JSON
- Schema (–æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ—Ä–º):
  - InputData:
    - version?: string (–≤–µ—Ä—Å–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, "3.8")
    - services?: Record<string, ServiceDefinition> (—Å–ª–æ–≤–∞—Ä—å —Å–µ—Ä–≤–∏—Å–æ–≤)
    - networks?: Record<string, NetworkDefinition> (—Å–ª–æ–≤–∞—Ä—å —Å–µ—Ç–µ–π)
  - ServiceDefinition:
    - image?: string
    - build?: BuildDefinition
    - ports?: string[] (–Ω–∞–ø—Ä–∏–º–µ—Ä, ["8000:8000"])
    - environment?: Record<string, string>
    - depends_on?: string[]
    - container_name?: string
    - networks?: string[]
    - volumes?: string[]
  - BuildDefinition:
    - context?: string
    - dockerfile?: string
  - NetworkDefinition:
    - driver?: string

### 3.2. Outputs (–í—ã—Ö–æ–¥—ã)

- Destination: STDOUT
- Format: JSON
- Success Criteria: Exit Code 0
- Schema (–æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–æ—Ä–º):
  - OutputResult:
    - success: boolean
    - message?: string
    - logs?: string[]
    - createdResources?: Array<{ type: string; name: string; id?: string }>

## 4. Implementation Details (The Source DNA / –ò—Å—Ö–æ–¥–Ω—ã–π –ö–æ–¥)

### 4.1. Algorithmic Logic (–î–ª—è –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ –∫–æ–¥–∞)

1. –ü—Ä–æ—á–∏—Ç–∞–π –°–∫—Ä–∏–∂–∞–ª—å docker-compose.yml –∫–∞–∫ –≠—Ñ–∏—Ä; —Ä–∞—Å–ø–∞—Ä—Å–∏ YAML-—Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –≤—ã–¥–µ–ª–∏ —Ä–∞–∑–¥–µ–ª—ã version, services, networks.
2. –í–∞–ª–∏–¥–∏—Ä—É–π –±–∞–∑–æ–≤—É—é –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É: –≤–µ—Ä—Å–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å "3.8"; —Ä–∞–∑–¥–µ–ª—ã services –∏ networks –¥–æ–ª–∂–Ω—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å.
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–∞–Ω–æ–Ω–∞–º –ê—Ä—Ç–µ—Ñ–∞–∫—Ç–∞:
   - app (–û–±–ª–∞—á–Ω—ã–π –ì–æ–ª–µ–º): build.context –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å ../../Scroll_28/Quest_2; image –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å codex/app-29-1-telemetry;ports –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 8000:8000; environment —Å–æ–¥–µ—Ä–∂–∏—Ç PORT=8000; networks –≤–∫–ª—é—á–∞–µ—Ç monitoring-net.
   - prometheus (–°—Ç—Ä–∞–∂ –ü—Ä–æ–º–µ—Ç–µ–π): image –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å prom/prometheus:latest; container_name ‚Äî —Ç–æ—á–Ω–æ–µ –∏–º—è; volumes –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ./prometheus.yml:/etc/prometheus/prometheus.yml; ports ‚Äî 9090:9090; depends_on –≤–∫–ª—é—á–∞–µ—Ç app; networks –≤–∫–ª—é—á–∞–µ—Ç monitoring-net.
   - grafana (–ü—Ä–æ–≤–∏–¥–µ—Ü): image –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å grafana/grafana:latest; container_name ‚Äî —Ç–æ—á–Ω–æ–µ –∏–º—è; ports ‚Äî 3000:3000; depends_on –≤–∫–ª—é—á–∞–µ—Ç prometheus; networks –≤–∫–ª—é—á–∞–µ—Ç monitoring-net.
4. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ç–∏ monitoring-net: driver ‚Äî bridge.
5. –ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞, –≤—ã–¥–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç –¥–µ–ø–ª–æ—è: –∫–æ–º–∞–Ω–¥—É docker-compose up -d –∏ –ø–æ—Å–ª–µ–¥—É—é—â—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ—Ä—Ç–æ–≤.
6. –í–µ—Ä–Ω—É—Ç—å –∏—Ç–æ–≥–æ–≤—ã–π –≠—Ñ–∏—Ä —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º —É—Å–ø–µ—Ö–∞ –∏, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –Ω–æ—Ç–∞—Ç–∏–Ω—ã –æ–± –æ—à–∏–±–∫–∞—Ö.
7. –í —Å–ª—É—á–∞–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –≤–µ—Ä–Ω—É—Ç—å —Ç–æ—á–µ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –•–∞–æ—Å–∞ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Å–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –ø—É–Ω–∫—Ç–æ–≤.

### 4.2. Declarative Content (–î–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –∏ –¥–∞–Ω–Ω—ã—Ö)

- –ò–º—É—â–µ—Å—Ç–≤–æ: —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–π –Ω–∞–±–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –∏—Ö –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π, –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ –°–∫—Ä–∏–∂–∞–ª–∏ (–≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–∏–∂–µ –æ—Ç—Ä–∞–∂–∞—é—Ç —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, 1-–≤-1):
  - üè∞ –û–±–ª–∞—á–Ω—ã–π –ì–æ–ª–µ–º (app)
    - image: codex/app-29-1-telemetry
    - build.context: ../../Scroll_28/Quest_2
    - ports: ["8000:8000"]
    - environment: PORT=8000
    - networks: [monitoring-net]

  - üõ°Ô∏è –°—Ç—Ä–∞–∂ –ü—Ä–æ–º–µ—Ç–µ–π (prometheus)
    - image: prom/prometheus:latest
    - container_name: prometheus_guardian
    - volumes: ["./prometheus.yml:/etc/prometheus/prometheus.yml"]
    - ports: ["9090:9090"]
    - depends_on: ["app"]
    - networks: [monitoring-net]

  - üè∞ –ü—Ä–æ–≤–∏–¥–µ—Ü —Å –•—Ä—É—Å—Ç–∞–ª—å–Ω—ã–º –ó–µ—Ä–∫–∞–ª–æ–º (grafana)
    - image: grafana/grafana:latest
    - container_name: grafana_seer
    - ports: ["3000:3000"]
    - depends_on: ["prometheus"]
    - networks: [monitoring-net]

  - Networks
    - monitoring-net: driver: bridge

## 5. Structural Decomposition (–î–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)

- –î–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π: –∫–ª—é—á–µ–≤—ã–µ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –±–ª–æ–∫–∏ ‚Äî services (app, prometheus, grafana), networks (monitoring-net), volumes (prometheus.yml).
- –î–ª—è –∫–æ–¥–∞: –∑–¥–µ—Å—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –∫–ª–∞—Å—Å—ã, ÎåÄÏã† —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏.

## 6. System Context & Constraints (–°–∏—Å—Ç–µ–º–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)

### 6.1. Technical Constraints

- Performance: Standard CPU
- Concurrency: Sync (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–æ–º –∑–∞–ø—É—Å–∫–∞ —á–µ—Ä–µ–∑ depends_on)
- Dependencies: Docker, Docker Compose
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: Prometheus, Grafana –æ–±—Ä–∞–º–ª—è—é—Ç —Å—Ç–µ–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### 6.2. Prohibited Actions (Negative Constraints)

- –ù–ï —Ö—Ä–∞–Ω–∏—Ç—å —Å–µ–∫—Ä–µ—Ç—ã –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º —Ç–µ–∫—Å—Ç–µ; –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å .env –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –æ–∫—Ä—É–∂–µ–Ω–∏—è.
- –ù–ï –≤—ã–≤–æ–¥–ª—è—Ç—å —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Å–æ–ª—å –≤ –ø—Ä–æ–¥–∞–∫—à–Ω-—Ä–µ–∂–∏–º–µ.
- –ù–ï –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –≤—ã–∑–æ–≤—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è.
- –ù–ï –æ–±–æ—Ä–∞—á–∏–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥–∏ (.yaml, .json) –≤ —Å–∫—Ä–∏–ø—Ç—ã.
- –ù–ï –º–µ–Ω—è—Ç—å –≤–µ—Ä—Å–∏–∏ –∏–ª–∏ –ø—É—Ç–∏ –≤–æ –≤—Ä–µ–º—è —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.

## 7. Verification & Testing (–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è)

–ì–µ—Ä–∫–∏–Ω-—Å—Ü–µ–Ω–∞—Ä–∏–∏

Feature: Docker Compose Deployment

Scenario: –£—Å–ø–µ—à–Ω–∞—è —Ä–∞–∑–≤—ë—Ä—Ç–∫–∞
Given —Ñ–∞–π–ª docker-compose.yml –≤–∞–ª–∏–¥–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
When –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É docker-compose up -d
Then –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã —Å—Ç–∞—Ä—Ç—É—é—Ç —É—Å–ø–µ—à–Ω–æ –∏ –ø–æ—Ä—Ç—ã 8000, 9090, 3000 –¥–æ—Å—Ç—É–ø–Ω—ã; –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

Scenario: –û—à–∏–±–∫–∞ –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è prometheus.yml
Given —Ñ–∞–π–ª prometheus.yml –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω
When –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É docker-compose up -d
Then Prometheus –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –≤ –ª–æ–≥–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ò–ó–´–°–ö–£–ï–ú–´–ô –ê–†–¢–ï–§–ê–ö–¢: docker-compose.yml

–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—É –≤ –¥—É—Ö–µ –í–µ–ª–∏–∫–∏—Ö –†–∏—Ç—É–∞–ª–æ–≤: —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ –∫–∞–∫ –µ—ë –≤–µ—Ä–Ω—É—Ç—å –≤ —Ä–∞–±–æ—á–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –µ—Å–ª–∏ –•–∞–æ—Å –∑–∞—Ç—Ä–æ–Ω–µ—Ç —Å–µ—Ç—å –Ω–∞–±–ª—é–¥–µ–Ω–∏—è. –í—Å–µ –æ–ø–∏—Å–∞–Ω–∏—è –≤–µ–¥—É—Ç –∫ —Ç–æ—á–Ω–æ–º—É –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é: —Ç—Ä–∏ –≥–æ–ª–µ–º–∞, –∏—Ö —Ç—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –∏ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ –∏–º–µ–Ω–∞.
