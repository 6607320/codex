# Этот комментарий — наставление от Мастера, объясняющее выбор "первозданной глины" для нашего Голема.
# Используем стандартный, полный образ Python. Он больше, но надежнее.
# Мы произносим главное заклинание `FROM`, которое говорит: "Начни творение с этого готового 'слепка мира'".
# Мы берем официальный, полный "слепок мира" с `python:3.10` в качестве нашей "первозданной глины".
FROM python:3.10

# Это наставление описывает следующий шаг: создание "мастерской".
# Устанавливаем рабочую директорию
# Мы произносим заклинание `WORKDIR`, которое создает внутри Голема "мастерскую" по имени `/app` и "входит" в нее.
WORKDIR /app

# Это наставление описывает ритуал копирования.
# Копируем свиток зависимостей
# Мы произносим заклинание `COPY`, телепортируя "свиток с перечнем гримуаров" (`requirements.txt`) в "мастерскую".
COPY requirements.txt .

# Это наставление объясняет, как мы будем призывать гримуары.
# Устанавливаем зависимости НАПРЯМУЮ в финальный образ
# Мы проводим ритуал (`RUN`), приказывая духу `pip` прочесть "свиток" и призвать все необходимые гримуары.
RUN pip install --no-cache-dir -r requirements.txt

# Это наставление описывает, как мы поместим "сердце" в нашего Голема.
# Копируем наш код
# Мы произносим еще одно заклинание `COPY`, телепортируя "сердце" нашего Голема (`main.py`) в "мастерскую".
COPY main.py .

# Это наставление описывает, как мы подготовим "свиток-пробудитель".
# Копируем и делаем исполняемым наш скрипт-пробудитель
# Мы телепортируем (`COPY`) наш "свиток-пробудитель" (`start.sh`) в "мастерскую".
COPY start.sh .
# Мы проводим еще один ритуал (`RUN`), накладывая "Руну-Печать Разрешения" (`chmod +x`) на наш "свиток-пробудитель".
RUN chmod +x ./start.sh

# Это наставление описывает, как Голем будет "оживать".
# Запускаем Голема через скрипт-пробудитель
# Мы накладываем "Главное Заклинание Жизни" (`CMD`), которое будет исполнено в момент пробуждения Голема.
# Он выполнит приказ, записанный в нашем "свитке-пробудителе".
CMD ["./start.sh"]
